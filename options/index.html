
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tuning/">
      
      
        <link rel="next" href="../papers/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Features and Options - PySR</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#features-and-options" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://astroautomata.com/PySR" title="PySR" class="md-header__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PySR
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Features and Options
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://astroautomata.com/PySR" title="PySR" class="md-nav__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    PySR
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toy Examples with Code
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PySRRegressor Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operators
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning and Workflow Tips
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Features and Options
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Features and Options
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Model selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      Operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iterations" class="md-nav__link">
    <span class="md-ellipsis">
      Iterations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cycles-per-iteration" class="md-nav__link">
    <span class="md-ellipsis">
      Cycles per iteration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processors" class="md-nav__link">
    <span class="md-ellipsis">
      Processors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#populations" class="md-nav__link">
    <span class="md-ellipsis">
      Populations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weighted-data" class="md-nav__link">
    <span class="md-ellipsis">
      Weighted data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#max-size" class="md-nav__link">
    <span class="md-ellipsis">
      Max size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batching" class="md-nav__link">
    <span class="md-ellipsis">
      Batching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variable-names" class="md-nav__link">
    <span class="md-ellipsis">
      Variable Names
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraining-use-of-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Constraining use of operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Custom complexity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#latex-and-sympy" class="md-nav__link">
    <span class="md-ellipsis">
      LaTeX and SymPy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exporting-to-numpy-pytorch-and-jax" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting to numpy, pytorch, and jax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-loading" class="md-nav__link">
    <span class="md-ellipsis">
      Model loading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../papers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../interactive-docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interactive Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Model selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      Operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iterations" class="md-nav__link">
    <span class="md-ellipsis">
      Iterations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cycles-per-iteration" class="md-nav__link">
    <span class="md-ellipsis">
      Cycles per iteration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processors" class="md-nav__link">
    <span class="md-ellipsis">
      Processors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#populations" class="md-nav__link">
    <span class="md-ellipsis">
      Populations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weighted-data" class="md-nav__link">
    <span class="md-ellipsis">
      Weighted data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#max-size" class="md-nav__link">
    <span class="md-ellipsis">
      Max size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batching" class="md-nav__link">
    <span class="md-ellipsis">
      Batching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variable-names" class="md-nav__link">
    <span class="md-ellipsis">
      Variable Names
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constraining-use-of-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Constraining use of operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Custom complexity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#latex-and-sympy" class="md-nav__link">
    <span class="md-ellipsis">
      LaTeX and SymPy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exporting-to-numpy-pytorch-and-jax" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting to numpy, pytorch, and jax
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-loading" class="md-nav__link">
    <span class="md-ellipsis">
      Model loading
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="features-and-options">Features and Options<a class="headerlink" href="#features-and-options" title="Permanent link">&para;</a></h1>
<p>Some configurable features and options in <code>PySR</code> which you
may find useful include:</p>
<ul>
<li><a href="#model-selection">Selecting from the accuracy-complexity curve</a></li>
<li><a href="#operators">Operators</a></li>
<li><a href="#iterations">Number of outer search iterations</a></li>
<li><a href="#cycles-per-iteration">Number of inner search iterations</a></li>
<li><a href="#processors">Multi-processing</a></li>
<li><a href="#populations">Populations</a></li>
<li><a href="#weighted-data">Data weighting</a></li>
<li><a href="#max-size">Max complexity and depth</a></li>
<li><a href="#batching">Mini-batching</a></li>
<li><a href="#variable-names">Variable names</a></li>
<li><a href="#constraining-use-of-operators">Constraining use of operators</a></li>
<li><a href="#custom-complexity">Custom complexities</a></li>
<li><a href="#latex-and-sympy">LaTeX and SymPy</a></li>
<li><a href="#exporting-to-numpy-pytorch-and-jax">Exporting to numpy, pytorch, and jax</a></li>
<li><a href="#loss">Loss functions</a></li>
<li><a href="#model-loading">Model loading</a></li>
</ul>
<p>These are described below.
Also check out the <a href="../tuning/">tuning page</a> for workflow tips.</p>
<p>The program will output a pandas DataFrame containing the equations
to <code>PySRRegressor.equations</code> containing the loss value
and complexity.</p>
<p>It will also dump to a csv
at the end of every iteration,
which is <code>.hall_of_fame_{date_time}.csv</code> by default.
It also prints the equations to stdout.</p>
<h2 id="model-selection">Model selection<a class="headerlink" href="#model-selection" title="Permanent link">&para;</a></h2>
<p>By default, <code>PySRRegressor</code> uses <code>model_selection='best'</code>
which selects an equation from <code>PySRRegressor.equations_</code> using
a combination of accuracy and complexity.
You can also select <code>model_selection='accuracy'</code>.</p>
<p>By printing a model (i.e., <code>print(model)</code>), you can see
the equation selection with the arrow shown in the <code>pick</code> column.</p>
<h2 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">&para;</a></h2>
<p>A list of operators can be found on the <a href="../operators/">operators page</a>.
One can define custom operators in Julia by passing a string:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">PySRRegressor</span><span class="p">(</span><span class="n">niterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">binary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mult&quot;</span><span class="p">,</span> <span class="s2">&quot;plus&quot;</span><span class="p">,</span> <span class="s2">&quot;special(x, y) = x^2 + y&quot;</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">extra_sympy_mappings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;special&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">},</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">unary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cos&quot;</span><span class="p">])</span>
</code></pre></div>
<p>Now, the symbolic regression code can search using this <code>special</code> function
that squares its left argument and adds it to its right. Make sure
all passed functions are valid Julia code, and take one (unary)
or two (binary) float32 scalars as input, and output a float32. This means if you
write any real constants in your operator, like <code>2.5</code>, you have to write them
instead as <code>2.5f0</code>, which defines it as <code>Float32</code>.
Operators are automatically vectorized.</p>
<p>One should also define <code>extra_sympy_mappings</code>,
so that the SymPy code can understand the output equation from Julia,
when constructing a useable function. This step is optional, but
is necessary for the <code>lambda_format</code> to work.</p>
<h2 id="iterations">Iterations<a class="headerlink" href="#iterations" title="Permanent link">&para;</a></h2>
<p>This is the total number of generations that <code>pysr</code> will run for.
I usually set this to a large number, and exit when I am satisfied
with the equations.</p>
<h2 id="cycles-per-iteration">Cycles per iteration<a class="headerlink" href="#cycles-per-iteration" title="Permanent link">&para;</a></h2>
<p>Each cycle considers every 10-equation subsample (re-sampled for each individual 10,
unless <code>fast_cycle</code> is set in which case the subsamples are separate groups of equations)
a single time, producing one mutated equation for each.
The parameter <code>ncycles_per_iteration</code> defines how many times this
occurs before the equations are compared to the hall of fame,
and new equations are migrated from the hall of fame, or from other populations.
It also controls how slowly annealing occurs. You may find that increasing
<code>ncycles_per_iteration</code> results in a higher cycles-per-second, as the head
worker needs to reduce and distribute new equations less often, and also increases
diversity. But at the same
time, a smaller number it might be that migrating equations from the hall of fame helps
each population stay closer to the best current equations.</p>
<h2 id="processors">Processors<a class="headerlink" href="#processors" title="Permanent link">&para;</a></h2>
<p>One can adjust the number of workers used by Julia with the
<code>procs</code> option. You should set this equal to the number of cores
you want <code>pysr</code> to use.</p>
<h2 id="populations">Populations<a class="headerlink" href="#populations" title="Permanent link">&para;</a></h2>
<p>By default, <code>populations=15</code>, but you can set a different
number of populations with this option.
More populations may increase
the diversity of equations discovered, though will take longer to train.
However, it is usually more efficient to have <code>populations&gt;procs</code>,
as there are multiple populations running
on each core.</p>
<h2 id="weighted-data">Weighted data<a class="headerlink" href="#weighted-data" title="Permanent link">&para;</a></h2>
<p>Here, we assign weights to each row of data
using inverse uncertainty squared. We also use 10 processes for the search
instead of the default.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">sigma</span> <span class="o">=</span> <span class="o">...</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">weights</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span><span class="n">procs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div>
<h2 id="max-size">Max size<a class="headerlink" href="#max-size" title="Permanent link">&para;</a></h2>
<p><code>maxsize</code> controls the maximum size of equation (number of operators,
constants, variables). <code>maxdepth</code> is by default not used, but can be set
to control the maximum depth of an equation. These will make processing
faster, as longer equations take longer to test.</p>
<p>One can warm up the maxsize from a small number to encourage
PySR to start simple, by using the <code>warmupMaxsize</code> argument.
This specifies that maxsize increases every <code>warmupMaxsize</code>.</p>
<h2 id="batching">Batching<a class="headerlink" href="#batching" title="Permanent link">&para;</a></h2>
<p>One can turn on mini-batching, with the <code>batching</code> flag,
and control the batch size with <code>batch_size</code>. This will make
evolution faster for large datasets. Equations are still evaluated
on the entire dataset at the end of each iteration to compare to the hall
of fame, but only on a random subset during mutations and annealing.</p>
<h2 id="variable-names">Variable Names<a class="headerlink" href="#variable-names" title="Permanent link">&para;</a></h2>
<p>You can pass a list of strings naming each column of <code>X</code> with
<code>variable_names</code>. Alternatively, you can pass <code>X</code> as a pandas dataframe
and the columns will be used as variable names. Make sure only
alphabetical characters and <code>_</code> are used in these names.</p>
<h2 id="constraining-use-of-operators">Constraining use of operators<a class="headerlink" href="#constraining-use-of-operators" title="Permanent link">&para;</a></h2>
<p>One can limit the complexity of specific operators with the <code>constraints</code> parameter.
There is a "maxsize" parameter to PySR, but there is also an operator-level
"constraints" parameter. One supplies a dict, like so:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">constraints</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pow&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;mult&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;cos&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</code></pre></div>
<p>What this says is that: a power law <span class="arithmatex">\(x^y\)</span> can have an expression of arbitrary (-1) complexity in the x, but only complexity 1 (e.g., a constant or variable) in the y. So <span class="arithmatex">\((x_0 + 3)^{5.5}\)</span> is allowed, but <span class="arithmatex">\(5.5^{x_0 + 3}\)</span> is not.
I find this helps a lot for getting more interpretable equations.
The other terms say that each multiplication can only have sub-expressions
of up to complexity 3 (e.g., <span class="arithmatex">\(5.0 + x_2\)</span>) in each side, and cosine can only operate on
expressions of complexity 5 (e.g., <span class="arithmatex">\(5.0 + x_2 exp(x_3)\)</span>).</p>
<h2 id="custom-complexity">Custom complexity<a class="headerlink" href="#custom-complexity" title="Permanent link">&para;</a></h2>
<p>By default, all operators, constants, and instances of variables
have a complexity of 1. The sum of the complexities of all terms
is the total complexity of an expression.
You may change this by configuring the options:</p>
<ul>
<li><code>complexity_of_operators</code> - pass a dictionary of <code>&lt;str&gt;: &lt;int&gt;</code> pairs
  to change the complexity of each operator. If an operator is not
  specified, it will have the default complexity of 1.</li>
<li><code>complexity_of_constants</code> - supplying an integer will make all constants
  have that complexity.</li>
<li><code>complexity_of_variables</code> - supplying an integer will make all variables
  have that complexity.</li>
</ul>
<h2 id="latex-and-sympy">LaTeX and SymPy<a class="headerlink" href="#latex-and-sympy" title="Permanent link">&para;</a></h2>
<p>After running <code>model.fit(...)</code>, you can look at
<code>model.equations</code> which is a pandas dataframe.
The <code>sympy_format</code> column gives sympy equations,
and the <code>lambda_format</code> gives callable functions.
You can optionally pass a pandas dataframe to the callable function,
if you called <code>.fit</code> on a pandas dataframe as well.</p>
<p>There are also some helper functions for doing this quickly.</p>
<ul>
<li><code>model.latex()</code> will generate a TeX formatted output of your equation.</li>
<li><code>model.latex_table(indices=[2, 5, 8])</code> will generate a formatted LaTeX table including all the specified equations.</li>
<li><code>model.sympy()</code> will return the SymPy representation.</li>
<li><code>model.jax()</code> will return a callable JAX function combined with parameters (see below)</li>
<li><code>model.pytorch()</code> will return a PyTorch model (see below).</li>
</ul>
<h2 id="exporting-to-numpy-pytorch-and-jax">Exporting to numpy, pytorch, and jax<a class="headerlink" href="#exporting-to-numpy-pytorch-and-jax" title="Permanent link">&para;</a></h2>
<p>By default, the dataframe of equations will contain columns
with the identifier <code>lambda_format</code>.
These are simple functions which correspond to the equation, but executed
with numpy functions.
You can pass your <code>X</code> matrix to these functions
just as you did to the <code>model.fit</code> call. Thus, this allows
you to numerically evaluate the equations over different output.</p>
<p>Calling <code>model.predict</code> will execute the <code>lambda_format</code> of
the best equation, and return the result. If you selected
<code>model_selection="best"</code>, this will use an equation that combines
accuracy with simplicity. For <code>model_selection="accuracy"</code>, this will just
look at accuracy.</p>
<p>One can do the same thing for PyTorch, which uses code
from <a href="https://github.com/patrick-kidger/sympytorch">sympytorch</a>,
and for JAX, which uses code from
<a href="https://github.com/MilesCranmer/sympy2jax">sympy2jax</a>.</p>
<p>Calling <code>model.pytorch()</code> will return
a PyTorch module which runs the equation, using PyTorch functions,
over <code>X</code> (as a PyTorch tensor). This is differentiable, and the
parameters of this PyTorch module correspond to the learned parameters
in the equation, and are trainable.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">torch_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pytorch</span><span class="p">()</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">torch_model</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div>
<p><strong>Warning: If you are using custom operators, you must define <code>extra_torch_mappings</code> or <code>extra_jax_mappings</code> (both are <code>dict</code> of callables) to provide an equivalent definition of the functions.</strong> (At any time you can set these parameters or any others with <code>model.set_params</code>.)</p>
<p>For JAX, you can equivalently call <code>model.jax()</code>
This will return a dictionary containing a <code>'callable'</code> (a JAX function),
and <code>'parameters'</code> (a list of parameters in the equation).
You can execute this function with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">jax_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">jax</span><span class="p">()</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">jax_model</span><span class="p">[</span><span class="s1">&#39;callable&#39;</span><span class="p">](</span><span class="n">X</span><span class="p">,</span> <span class="n">jax_model</span><span class="p">[</span><span class="s1">&#39;parameters&#39;</span><span class="p">])</span>
</code></pre></div>
<p>Since the parameter list is a jax array, this therefore lets you also
train the parameters within JAX (and is differentiable).</p>
<h2 id="loss"><code>loss</code><a class="headerlink" href="#loss" title="Permanent link">&para;</a></h2>
<p>The default loss is mean-square error, and weighted mean-square error.
One can pass an arbitrary Julia string to define a custom loss, using,
e.g., <code>elementwise_loss="myloss(x, y) = abs(x - y)^1.5"</code>. For more details,
see the
<a href="https://milescranmer.github.io/SymbolicRegression.jl/dev/losses/">Losses</a>
page for SymbolicRegression.jl.</p>
<p>Here are some additional examples:</p>
<p>abs(x-y) loss</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">PySRRegressor</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;f(x, y) = abs(x - y)^1.5&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Note that the function name doesn't matter:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">PySRRegressor</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;loss(x, y) = abs(x * y)&quot;</span><span class="p">)</span>
</code></pre></div>
<p>With weights:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;myloss(x, y, w) = w * abs(x - y)&quot;</span><span class="p">)</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div>
<p>Weights can be used in arbitrary ways:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;myloss(x, y, w) = abs(x - y)^2/w^2&quot;</span><span class="p">)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div>
<p>Built-in loss (faster) (see <a href="https://astroautomata.com/SymbolicRegression.jl/dev/losses/">losses</a>).
This one computes the L3 norm:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">PySRRegressor</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;LPDistLoss</span><span class="si">{3}</span><span class="s2">()&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Can also uses these losses for weighted (weighted-average):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">elementwise_loss</span><span class="o">=</span><span class="s2">&quot;LPDistLoss</span><span class="si">{3}</span><span class="s2">()&quot;</span><span class="p">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div>
<h2 id="model-loading">Model loading<a class="headerlink" href="#model-loading" title="Permanent link">&para;</a></h2>
<p>PySR will automatically save a pickle file of the model state
when you call <code>model.fit</code>, once before the search starts,
and again after the search finishes. The filename will
have the same base name as the input file, but with a <code>.pkl</code> extension.
You can load the saved model state with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">pickle_filename</span><span class="p">)</span>
</code></pre></div>
<p>If you have a long-running job and would like to load the model
before completion, you can also do this. In this case, the model
loading will use the <code>csv</code> file to load the equations, since the
<code>csv</code> file is continually updated during the search. Once
the search completes, the model including its equations will
be saved to the pickle file, overwriting the existing version.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>
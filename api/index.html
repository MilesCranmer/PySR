
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../examples/">
      
      
        <link rel="next" href="../operators/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>API Reference - PySR</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://ai.damtp.cam.ac.uk/pysr" title="PySR" class="md-header__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PySR
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ai.damtp.cam.ac.uk/pysr" title="PySR" class="md-nav__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    PySR
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Toy Examples with Code
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      The Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-search-space" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Search Space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-the-search-size" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the Search Size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-objective" class="md-nav__link">
    <span class="md-ellipsis">
      The Objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-complexities" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Complexities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutations" class="md-nav__link">
    <span class="md-ellipsis">
      Mutations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tournament-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Tournament Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constant-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Constant Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-between-populations" class="md-nav__link">
    <span class="md-ellipsis">
      Migration between Populations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Stopping Criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-and-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance and Parallelization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determinism" class="md-nav__link">
    <span class="md-ellipsis">
      Determinism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    <span class="md-ellipsis">
      Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exporting-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting the Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.sympy" class="md-nav__link">
    <span class="md-ellipsis">
      sympy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex" class="md-nav__link">
    <span class="md-ellipsis">
      latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.jax" class="md-nav__link">
    <span class="md-ellipsis">
      jax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex_table" class="md-nav__link">
    <span class="md-ellipsis">
      latex_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expression-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Expression Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expression Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.ExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.TemplateExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      TemplateExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.ParametricExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ParametricExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      AbstractExpressionSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AbstractExpressionSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec.create_exports" class="md-nav__link">
    <span class="md-ellipsis">
      create_exports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec.julia_expression_spec" class="md-nav__link">
    <span class="md-ellipsis">
      julia_expression_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logger-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Logger Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logger Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.TensorBoardLoggerSpec" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardLoggerSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec" class="md-nav__link">
    <span class="md-ellipsis">
      AbstractLoggerSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AbstractLoggerSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.create_logger" class="md-nav__link">
    <span class="md-ellipsis">
      create_logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.write_hparams" class="md-nav__link">
    <span class="md-ellipsis">
      write_hparams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operators
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tuning and Workflow Tips
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features and Options
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../papers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Internal Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customization
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      The Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-search-space" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Search Space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-the-search-size" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the Search Size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-objective" class="md-nav__link">
    <span class="md-ellipsis">
      The Objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-complexities" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Complexities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutations" class="md-nav__link">
    <span class="md-ellipsis">
      Mutations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tournament-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Tournament Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constant-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Constant Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-between-populations" class="md-nav__link">
    <span class="md-ellipsis">
      Migration between Populations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Stopping Criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-and-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance and Parallelization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determinism" class="md-nav__link">
    <span class="md-ellipsis">
      Determinism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    <span class="md-ellipsis">
      Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exporting-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting the Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.sympy" class="md-nav__link">
    <span class="md-ellipsis">
      sympy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex" class="md-nav__link">
    <span class="md-ellipsis">
      latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.jax" class="md-nav__link">
    <span class="md-ellipsis">
      jax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex_table" class="md-nav__link">
    <span class="md-ellipsis">
      latex_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expression-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Expression Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expression Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.ExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.TemplateExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      TemplateExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.ParametricExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ParametricExpressionSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec" class="md-nav__link">
    <span class="md-ellipsis">
      AbstractExpressionSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AbstractExpressionSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec.create_exports" class="md-nav__link">
    <span class="md-ellipsis">
      create_exports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractExpressionSpec.julia_expression_spec" class="md-nav__link">
    <span class="md-ellipsis">
      julia_expression_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logger-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Logger Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Logger Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.TensorBoardLoggerSpec" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardLoggerSpec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec" class="md-nav__link">
    <span class="md-ellipsis">
      AbstractLoggerSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AbstractLoggerSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.create_logger" class="md-nav__link">
    <span class="md-ellipsis">
      create_logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.AbstractLoggerSpec.write_hparams" class="md-nav__link">
    <span class="md-ellipsis">
      write_hparams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p><code>PySRRegressor</code> has many options for controlling a symbolic regression search.
Let's look at them below.</p>
<h2 id="pysrregressor-parameters">PySRRegressor Parameters<a class="headerlink" href="#pysrregressor-parameters" title="Permanent link">&para;</a></h2>
<h3 id="the-algorithm">The Algorithm<a class="headerlink" href="#the-algorithm" title="Permanent link">&para;</a></h3>
<h4 id="creating-the-search-space">Creating the Search Space<a class="headerlink" href="#creating-the-search-space" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>binary_operators</code></strong></p>
<p>List of strings for binary operators used in the search.
See the <a href="https://ai.damtp.cam.ac.uk/pysr/operators/">operators page</a>
for more details.</p>
<p><em>Default:</em> <code>["+", "-", "*", "/"]</code></p>
</li>
<li>
<p><strong><code>unary_operators</code></strong></p>
<p>Operators which only take a single scalar as input.
For example, <code>"cos"</code> or <code>"exp"</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>operators</code></strong></p>
<p>Generic operators by arity (number of arguments). Keys are integers
representing arity, values are lists of operator strings.
Example: <code>{1: ["sin", "cos"], 2: ["+", "-", "*"], 3: ["muladd"]}</code>.
Cannot be used with <code>binary_operators</code> or <code>unary_operators</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>expression_spec</code></strong></p>
<p>The type of expression to search for. By default,
this is just <code>ExpressionSpec()</code>. You can also use
<code>TemplateExpressionSpec(...)</code> which allows you to specify
a custom template for the expressions.</p>
<p><em>Default:</em> <code>ExpressionSpec()</code></p>
</li>
<li>
<p><strong><code>maxsize</code></strong></p>
<p>Max complexity of an equation.  </p>
<p><em>Default:</em> <code>30</code></p>
</li>
<li>
<p><strong><code>maxdepth</code></strong></p>
<p>Max depth of an equation. You can use both <code>maxsize</code> and
<code>maxdepth</code>. <code>maxdepth</code> is by default not used.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h4 id="setting-the-search-size">Setting the Search Size<a class="headerlink" href="#setting-the-search-size" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>niterations</code></strong></p>
<p>Number of iterations of the algorithm to run. The best
equations are printed and migrate between populations at the
end of each iteration.</p>
<p><em>Default:</em> <code>100</code></p>
</li>
<li>
<p><strong><code>populations</code></strong></p>
<p>Number of populations running.</p>
<p><em>Default:</em> <code>31</code></p>
</li>
<li>
<p><strong><code>population_size</code></strong></p>
<p>Number of individuals in each population.</p>
<p><em>Default:</em> <code>27</code></p>
</li>
<li>
<p><strong><code>ncycles_per_iteration</code></strong></p>
<p>Number of total mutations to run, per 10 samples of the
population, per iteration.</p>
<p><em>Default:</em> <code>380</code></p>
</li>
</ul>
<h4 id="the-objective">The Objective<a class="headerlink" href="#the-objective" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>elementwise_loss</code></strong></p>
<p>String of Julia code specifying an elementwise loss function.
Can either be a loss from LossFunctions.jl, or your own loss
written as a function. Examples of custom written losses include:
<code>myloss(x, y) = abs(x-y)</code> for non-weighted, or
<code>myloss(x, y, w) = w*abs(x-y)</code> for weighted.
The included losses include:
Regression: <code>LPDistLoss{P}()</code>, <code>L1DistLoss()</code>,
<code>L2DistLoss()</code> (mean square), <code>LogitDistLoss()</code>,
<code>HuberLoss(d)</code>, <code>L1EpsilonInsLoss(ϵ)</code>, <code>L2EpsilonInsLoss(ϵ)</code>,
<code>PeriodicLoss(c)</code>, <code>QuantileLoss(τ)</code>.
Classification: <code>ZeroOneLoss()</code>, <code>PerceptronLoss()</code>,
<code>L1HingeLoss()</code>, <code>SmoothedL1HingeLoss(γ)</code>,
<code>ModifiedHuberLoss()</code>, <code>L2MarginLoss()</code>, <code>ExpLoss()</code>,
<code>SigmoidLoss()</code>, <code>DWDMarginLoss(q)</code>.</p>
<p><em>Default:</em> <code>"L2DistLoss()"</code></p>
</li>
<li>
<p><strong><code>loss_function</code></strong></p>
<p>Alternatively, you can specify the full objective function as
a snippet of Julia code, including any sort of custom evaluation
(including symbolic manipulations beforehand), and any sort
of loss function or regularizations. The default <code>loss_function</code>
used in SymbolicRegression.jl is roughly equal to:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">function</span><span class="w"> </span><span class="n">eval_loss</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="o">::</span><span class="kt">Dataset</span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">L</span><span class="p">},</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="o">::</span><span class="kt">L</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">L</span><span class="p">}</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="n">prediction</span><span class="p">,</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eval_tree_array</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">flag</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="nb">Inf</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sum</span><span class="p">((</span><span class="n">prediction</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">.^</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dataset</span><span class="o">.</span><span class="n">n</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">end</span>
</code></pre></div>
where the example elementwise loss is mean-squared error.
You may pass a function with the same arguments as this (note
that the name of the function doesn't matter). Here,
both <code>prediction</code> and <code>dataset.y</code> are 1D arrays of length <code>dataset.n</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>loss_function_expression</code></strong></p>
<p>Similar to <code>loss_function</code>, but takes as input the full
expression object as the first argument, rather than
the innermost <code>AbstractExpressionNode</code>. This is useful
for specifying custom loss functions on <code>TemplateExpressionSpec</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>loss_scale</code></strong></p>
<p>Determines how loss values are scaled when computing scores.
"log" (default) uses logarithmic scaling of loss ratios; this mode
requires non-negative loss values and is ideal for traditional
loss functions that are always non-negative.
"linear" uses direct
differences between losses; this mode handles any loss values
(including negative) and is useful for custom loss functions,
especially those based on likelihoods.</p>
</li>
<li>
<p><strong><code>model_selection</code></strong></p>
<p>Model selection criterion when selecting a final expression from
the list of best expression at each complexity.
Can be <code>'accuracy'</code>, <code>'best'</code>, or <code>'score'</code>. 
<code>'accuracy'</code> selects the candidate model with the lowest loss
(highest accuracy).
<code>'score'</code> selects the candidate model with the highest score.
Score is defined as the negated derivative of the log-loss with
respect to complexity - if an expression has a much better
loss at a slightly higher complexity, it is preferred.
<code>'best'</code> selects the candidate model with the highest score
among expressions with a loss better than at least 1.5x the
most accurate model.</p>
<p><em>Default:</em> <code>'best'</code></p>
</li>
<li>
<p><strong><code>dimensional_constraint_penalty</code></strong></p>
<p>Additive penalty for if dimensional analysis of an expression fails.
By default, this is <code>1000.0</code>.</p>
</li>
<li>
<p><strong><code>dimensionless_constants_only</code></strong></p>
<p>Whether to only search for dimensionless constants, if using units.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
</ul>
<h4 id="working-with-complexities">Working with Complexities<a class="headerlink" href="#working-with-complexities" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>parsimony</code></strong></p>
<p>Multiplicative factor for how much to punish complexity.</p>
<p><em>Default:</em> <code>0.0</code></p>
</li>
<li>
<p><strong><code>constraints</code></strong></p>
<p>Dictionary of int (unary) or tuples (multi-arity), this enforces
maxsize constraints on the individual arguments of operators.
E.g., <code>'pow': (-1, 1)</code> says that power laws can have any
complexity left argument, but only 1 complexity in the right
argument. For arity-3 operators like muladd, use 3-tuples like
<code>'muladd': (-1, -1, 1)</code> to constrain each argument's complexity.
Use this to force more interpretable solutions.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>nested_constraints</code></strong></p>
<p>Specifies how many times a combination of operators can be
nested. For example, <code>{"sin": {"cos": 0}}, "cos": {"cos": 2}}</code>
specifies that <code>cos</code> may never appear within a <code>sin</code>, but <code>sin</code>
can be nested with itself an unlimited number of times. The
second term specifies that <code>cos</code> can be nested up to 2 times
within a <code>cos</code>, so that <code>cos(cos(cos(x)))</code> is allowed
(as well as any combination of <code>+</code> or <code>-</code> within it), but
<code>cos(cos(cos(cos(x))))</code> is not allowed. When an operator is not
specified, it is assumed that it can be nested an unlimited
number of times. This requires that there is no operator which
is used both in the unary operators and the binary operators
(e.g., <code>-</code> could be both subtract, and negation). For binary
operators, you only need to provide a single number: both
arguments are treated the same way, and the max of each
argument is constrained.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>complexity_of_operators</code></strong></p>
<p>If you would like to use a complexity other than 1 for an
operator, specify the complexity here. For example,
<code>{"sin": 2, "+": 1}</code> would give a complexity of 2 for each use
of the <code>sin</code> operator, and a complexity of 1 for each use of
the <code>+</code> operator (which is the default). You may specify real
numbers for a complexity, and the total complexity of a tree
will be rounded to the nearest integer after computing.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>complexity_of_constants</code></strong></p>
<p>Complexity of constants. </p>
<p><em>Default:</em> <code>1</code></p>
</li>
<li>
<p><strong><code>complexity_of_variables</code></strong></p>
<p>Global complexity of variables. To set different complexities for
different variables, pass a list of complexities to the <code>fit</code> method
with keyword <code>complexity_of_variables</code>. You cannot use both.</p>
<p><em>Default:</em> <code>1</code></p>
</li>
<li>
<p><strong><code>complexity_mapping</code></strong></p>
<p>Alternatively, you can pass a function (a string of Julia code) that
takes the expression as input and returns the complexity. Make sure that
this operates on <code>AbstractExpression</code> (and unpacks to <code>AbstractExpressionNode</code>),
and returns an integer.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>warmup_maxsize_by</code></strong></p>
<p>Whether to slowly increase max size from a small number up to
the maxsize (if greater than 0).  If greater than 0, says the
fraction of training time at which the current maxsize will
reach the user-passed maxsize.</p>
<p><em>Default:</em> <code>0.0</code></p>
</li>
<li>
<p><strong><code>use_frequency</code></strong></p>
<p>Whether to measure the frequency of complexities, and use that
instead of parsimony to explore equation space. Will naturally
find equations of all complexities.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>use_frequency_in_tournament</code></strong></p>
<p>Whether to use the frequency mentioned above in the tournament,
rather than just the simulated annealing.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>adaptive_parsimony_scaling</code></strong></p>
<p>If the adaptive parsimony strategy (<code>use_frequency</code> and
<code>use_frequency_in_tournament</code>), this is how much to (exponentially)
weight the contribution. If you find that the search is only optimizing
the most complex expressions while the simpler expressions remain stagnant,
you should increase this value.</p>
<p><em>Default:</em> <code>1040.0</code></p>
</li>
<li>
<p><strong><code>should_simplify</code></strong></p>
<p>Whether to use algebraic simplification in the search. Note that only
a few simple rules are implemented. </p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h4 id="mutations">Mutations<a class="headerlink" href="#mutations" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>weight_add_node</code></strong></p>
<p>Relative likelihood for mutation to add a node.</p>
<p><em>Default:</em> <code>2.47</code></p>
</li>
<li>
<p><strong><code>weight_insert_node</code></strong></p>
<p>Relative likelihood for mutation to insert a node.</p>
<p><em>Default:</em> <code>0.0112</code></p>
</li>
<li>
<p><strong><code>weight_delete_node</code></strong></p>
<p>Relative likelihood for mutation to delete a node.</p>
<p><em>Default:</em> <code>0.870</code></p>
</li>
<li>
<p><strong><code>weight_do_nothing</code></strong></p>
<p>Relative likelihood for mutation to leave the individual.</p>
<p><em>Default:</em> <code>0.273</code></p>
</li>
<li>
<p><strong><code>weight_mutate_constant</code></strong></p>
<p>Relative likelihood for mutation to change the constant slightly
in a random direction.</p>
<p><em>Default:</em> <code>0.0346</code></p>
</li>
<li>
<p><strong><code>weight_mutate_operator</code></strong></p>
<p>Relative likelihood for mutation to swap an operator.</p>
<p><em>Default:</em> <code>0.293</code></p>
</li>
<li>
<p><strong><code>weight_mutate_feature</code></strong></p>
<p>Relative likelihood for mutation to change which feature a variable node references.</p>
<p><em>Default:</em> <code>0.1</code></p>
</li>
<li>
<p><strong><code>weight_swap_operands</code></strong></p>
<p>Relative likehood for swapping operands in binary operators.</p>
<p><em>Default:</em> <code>0.198</code></p>
</li>
<li>
<p><strong><code>weight_rotate_tree</code></strong></p>
<p>How often to perform a tree rotation at a random node.</p>
<p><em>Default:</em> <code>4.26</code></p>
</li>
<li>
<p><strong><code>weight_randomize</code></strong></p>
<p>Relative likelihood for mutation to completely delete and then
randomly generate the equation</p>
<p><em>Default:</em> <code>0.000502</code></p>
</li>
<li>
<p><strong><code>weight_simplify</code></strong></p>
<p>Relative likelihood for mutation to simplify constant parts by evaluation</p>
<p><em>Default:</em> <code>0.00209</code></p>
</li>
<li>
<p><strong><code>weight_optimize</code></strong></p>
<p>Constant optimization can also be performed as a mutation, in addition to
the normal strategy controlled by <code>optimize_probability</code> which happens
every iteration. Using it as a mutation is useful if you want to use
a large <code>ncycles_periteration</code>, and may not optimize very often.</p>
<p><em>Default:</em> <code>0.0</code></p>
</li>
<li>
<p><strong><code>crossover_probability</code></strong></p>
<p>Absolute probability of crossover-type genetic operation, instead of a mutation.</p>
<p><em>Default:</em> <code>0.0259</code></p>
</li>
<li>
<p><strong><code>annealing</code></strong></p>
<p>Whether to use annealing.  </p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>alpha</code></strong></p>
<p>Initial temperature for simulated annealing
(requires <code>annealing</code> to be <code>True</code>).</p>
<p><em>Default:</em> <code>3.17</code></p>
</li>
<li>
<p><strong><code>perturbation_factor</code></strong></p>
<p>Constants are perturbed by a max factor of
(perturbation_factor*T + 1). Either multiplied by this or
divided by this.</p>
<p><em>Default:</em> <code>0.129</code></p>
</li>
<li>
<p><strong><code>probability_negate_constant</code></strong></p>
<p>Probability of negating a constant in the equation when mutating it.</p>
<p><em>Default:</em> <code>0.00743</code></p>
</li>
<li>
<p><strong><code>skip_mutation_failures</code></strong></p>
<p>Whether to skip mutation and crossover failures, rather than
simply re-sampling the current member.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h4 id="tournament-selection">Tournament Selection<a class="headerlink" href="#tournament-selection" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>tournament_selection_n</code></strong></p>
<p>Number of expressions to consider in each tournament.</p>
<p><em>Default:</em> <code>15</code></p>
</li>
<li>
<p><strong><code>tournament_selection_p</code></strong></p>
<p>Probability of selecting the best expression in each
tournament. The probability will decay as p*(1-p)^n for other
expressions, sorted by loss.</p>
<p><em>Default:</em> <code>0.982</code></p>
</li>
</ul>
<h4 id="constant-optimization">Constant Optimization<a class="headerlink" href="#constant-optimization" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>optimizer_algorithm</code></strong></p>
<p>Optimization scheme to use for optimizing constants. Can currently
be <code>NelderMead</code> or <code>BFGS</code>.</p>
<p><em>Default:</em> <code>"BFGS"</code></p>
</li>
<li>
<p><strong><code>optimizer_nrestarts</code></strong></p>
<p>Number of time to restart the constants optimization process with
different initial conditions.</p>
<p><em>Default:</em> <code>2</code></p>
</li>
<li>
<p><strong><code>optimizer_f_calls_limit</code></strong></p>
<p>How many function calls to allow during optimization.</p>
<p><em>Default:</em> <code>10_000</code></p>
</li>
<li>
<p><strong><code>optimize_probability</code></strong></p>
<p>Probability of optimizing the constants during a single iteration of
the evolutionary algorithm.</p>
<p><em>Default:</em> <code>0.14</code></p>
</li>
<li>
<p><strong><code>optimizer_iterations</code></strong></p>
<p>Number of iterations that the constants optimizer can take.</p>
<p><em>Default:</em> <code>8</code></p>
</li>
<li>
<p><strong><code>should_optimize_constants</code></strong></p>
<p>Whether to numerically optimize constants (Nelder-Mead/Newton)
at the end of each iteration. </p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h4 id="migration-between-populations">Migration between Populations<a class="headerlink" href="#migration-between-populations" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>fraction_replaced</code></strong></p>
<p>How much of population to replace with migrating equations from
other populations.</p>
<p><em>Default:</em> <code>0.00036</code></p>
</li>
<li>
<p><strong><code>fraction_replaced_hof</code></strong></p>
<p>How much of population to replace with migrating equations from
hall of fame. </p>
<p><em>Default:</em> <code>0.0614</code></p>
</li>
<li>
<p><strong><code>fraction_replaced_guesses</code></strong></p>
<p>How much of the population to replace with migrating equations from
guesses. </p>
<p><em>Default:</em> <code>0.001</code></p>
</li>
<li>
<p><strong><code>migration</code></strong></p>
<p>Whether to migrate.  </p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>hof_migration</code></strong></p>
<p>Whether to have the hall of fame migrate.  </p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>topn</code></strong></p>
<p>How many top individuals migrate from each population.</p>
<p><em>Default:</em> <code>12</code></p>
</li>
</ul>
<h3 id="data-preprocessing">Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>denoise</code></strong></p>
<p>Whether to use a Gaussian Process to denoise the data before
inputting to PySR. Can help PySR fit noisy data.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>select_k_features</code></strong></p>
<p>Whether to run feature selection in Python using random forests,
before passing to the symbolic regression code. None means no
feature selection; an int means select that many features.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h3 id="stopping-criteria">Stopping Criteria<a class="headerlink" href="#stopping-criteria" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>max_evals</code></strong></p>
<p>Limits the total number of evaluations of expressions to
this number.  </p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>timeout_in_seconds</code></strong></p>
<p>Make the search return early once this many seconds have passed.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>early_stop_condition</code></strong></p>
<p>Stop the search early if this loss is reached. You may also
pass a string containing a Julia function which
takes a loss and complexity as input, for example:
<code>"f(loss, complexity) = (loss &lt; 0.1) &amp;&amp; (complexity &lt; 10)"</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h3 id="performance-and-parallelization">Performance and Parallelization<a class="headerlink" href="#performance-and-parallelization" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>parallelism</code></strong></p>
<p>Parallelism to use for the search. Can be <code>"serial"</code>, <code>"multithreading"</code>, or <code>"multiprocessing"</code>.</p>
<p><em>Default:</em> <code>"multithreading"</code></p>
</li>
<li>
<p><strong><code>procs</code></strong></p>
<p>Number of processes to use for parallelism. If <code>None</code>, defaults to <code>cpu_count()</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>cluster_manager</code></strong></p>
<p>For distributed computing, this sets the job queue system. Set
to one of "slurm", "pbs", "lsf", "sge", "qrsh", "scyld", or
"htc". If set to one of these, PySR will run in distributed
mode, and use <code>procs</code> to figure out how many processes to launch.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>heap_size_hint_in_bytes</code></strong></p>
<p>For multiprocessing, this sets the <code>--heap-size-hint</code> parameter
for new Julia processes. This can be configured when using
multi-node distributed compute, to give a hint to each process
about how much memory they can use before aggressive garbage
collection.</p>
</li>
<li>
<p><strong><code>worker_timeout</code></strong></p>
<p>Timeout in seconds for worker processes during multiprocessing to respond.
If a worker does not respond within this time, it will be restarted.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>worker_imports</code></strong></p>
<p>List of module names as strings to import in worker processes.
For example, <code>["MyPackage", "OtherPackage"]</code> will run <code>using MyPackage, OtherPackage</code>
in each worker process. </p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>batching</code></strong></p>
<p>Whether to compare population members on small batches during
evolution. Still uses full dataset for comparing against hall
of fame. "auto" enables batching for N&gt;1000. </p>
<p><em>Default:</em> <code>"auto"</code></p>
</li>
<li>
<p><strong><code>batch_size</code></strong></p>
<p>The batch size to use if batching. If None, uses the
full dataset when N&lt;=1000, 128 for N&lt;5000, 256 for N&lt;50000,
or 512 for N≥50000. </p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>precision</code></strong></p>
<p>What precision to use for the data. By default this is <code>32</code>
(float32), but you can select <code>64</code> or <code>16</code> as well, giving
you 64 or 16 bits of floating point precision, respectively.
If you pass complex data, the corresponding complex precision
will be used (i.e., <code>64</code> for complex128, <code>32</code> for complex64).</p>
<p><em>Default:</em> <code>32</code></p>
</li>
<li>
<p><strong><code>fast_cycle</code></strong></p>
<p>Batch over population subsamples. This is a slightly different
algorithm than regularized evolution, but does cycles 15%
faster. May be algorithmically less efficient.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>turbo</code></strong></p>
<p>(Experimental) Whether to use LoopVectorization.jl to speed up the
search evaluation. Certain operators may not be supported.
Does not support 16-bit precision floats.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>bumper</code></strong></p>
<p>(Experimental) Whether to use Bumper.jl to speed up the search
evaluation. Does not support 16-bit precision floats.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>autodiff_backend</code></strong></p>
<p>Which backend to use for automatic differentiation during constant
optimization. Currently <code>"Zygote"</code>, <code>"Mooncake"</code>, and <code>"Enzyme"</code> are supported.
The default, <code>None</code>, uses forward-mode or finite difference.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h3 id="determinism">Determinism<a class="headerlink" href="#determinism" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>random_state</code></strong></p>
<p>Pass an int for reproducible results across multiple function calls.
See :term:<code>Glossary &lt;random_state&gt;</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>deterministic</code></strong></p>
<p>Make a PySR search give the same result every run.
To use this, you must turn off parallelism
(with <code>parallelism="serial"</code>),
and set <code>random_state</code> to a fixed seed.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>warm_start</code></strong></p>
<p>Tells fit to continue from where the last call to fit finished.
If false, each call to fit will be fresh, overwriting previous results.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>guesses</code></strong></p>
<p>Initial guesses for expressions to seed the search. Examples:
<code>["x0 + x1", "x0^2"]</code>, <code>[["x0"], ["x1"]]</code> (multi-output),
<code>[{"f": "#1 + #2"}]</code> (TemplateExpressionSpec where <code>#1</code>, <code>#2</code> are
placeholders for the 1st, 2nd arguments of expression <code>f</code>).</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h3 id="monitoring">Monitoring<a class="headerlink" href="#monitoring" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>verbosity</code></strong></p>
<p>What verbosity level to use. 0 means minimal print statements.</p>
<p><em>Default:</em> <code>1</code></p>
</li>
<li>
<p><strong><code>update_verbosity</code></strong></p>
<p>What verbosity level to use for package updates.
Will take value of <code>verbosity</code> if not given.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>print_precision</code></strong></p>
<p>How many significant digits to print for floats. </p>
<p><em>Default:</em> <code>5</code></p>
</li>
<li>
<p><strong><code>progress</code></strong></p>
<p>Whether to use a progress bar instead of printing to stdout.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>logger_spec</code></strong></p>
<p>Logger specification for the Julia backend. See, for example,
<code>TensorBoardLoggerSpec</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>input_stream</code></strong></p>
<p>The stream to read user input from. By default, this is <code>"stdin"</code>.
If you encounter issues with reading from <code>stdin</code>, like a hang,
you can simply pass <code>"devnull"</code> to this argument. You can also
reference an arbitrary Julia object in the <code>Main</code> namespace.</p>
<p><em>Default:</em> <code>"stdin"</code></p>
</li>
</ul>
<h3 id="environment">Environment<a class="headerlink" href="#environment" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>temp_equation_file</code></strong></p>
<p>Whether to put the hall of fame file in the temp directory.
Deletion is then controlled with the <code>delete_tempfiles</code>
parameter.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>tempdir</code></strong></p>
<p>directory for the temporary files. </p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>delete_tempfiles</code></strong></p>
<p>Whether to delete the temporary files after finishing.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>update</code></strong></p>
<p>Whether to automatically update Julia packages when <code>fit</code> is called.
You should make sure that PySR is up-to-date itself first, as
the packaged Julia packages may not necessarily include all
updated dependencies.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
</ul>
<h3 id="exporting-the-results">Exporting the Results<a class="headerlink" href="#exporting-the-results" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>output_directory</code></strong></p>
<p>The base directory to save output files to. Files
will be saved in a subdirectory according to the run ID.
Will be set to <code>outputs/</code> if not provided.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>run_id</code></strong></p>
<p>A unique identifier for the run. Will be generated using the
current date and time if not provided.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>output_jax_format</code></strong></p>
<p>Whether to create a 'jax_format' column in the output,
containing jax-callable functions and the default parameters in
a jax array.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>output_torch_format</code></strong></p>
<p>Whether to create a 'torch_format' column in the output,
containing a torch module with trainable parameters.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>extra_sympy_mappings</code></strong></p>
<p>Provides mappings between custom <code>binary_operators</code> or
<code>unary_operators</code> defined in julia strings, to those same
operators defined in sympy.
E.G if <code>unary_operators=["inv(x)=1/x"]</code>, then for the fitted
model to be export to sympy, <code>extra_sympy_mappings</code>
would be <code>{"inv": lambda x: 1/x}</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>extra_torch_mappings</code></strong></p>
<p>The same as <code>extra_jax_mappings</code> but for model export
to pytorch. Note that the dictionary keys should be callable
pytorch expressions.
For example: <code>extra_torch_mappings={sympy.sin: torch.sin}</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>extra_jax_mappings</code></strong></p>
<p>Similar to <code>extra_sympy_mappings</code> but for model export
to jax. The dictionary maps sympy functions to jax functions.
For example: <code>extra_jax_mappings={sympy.sin: "jnp.sin"}</code> maps
the <code>sympy.sin</code> function to the equivalent jax expression <code>jnp.sin</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h2 id="pysrregressor-functions">PySRRegressor Functions<a class="headerlink" href="#pysrregressor-functions" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">Xresampled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variable_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complexity_of_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Search for equations to fit the dataset and store them in <code>self.equations_</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data of shape (n_samples, n_features).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target values of shape (n_samples,) or (n_samples, n_targets).
Will be cast to X's dtype if necessary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Xresampled</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resampled training data, of shape (n_resampled, n_features),
to generate a denoised data on. This
will be used as the training data, rather than <code>X</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight array of the same shape as <code>y</code>.
Each element is how to weight the mean-square-error loss
for that particular element of <code>y</code>. Alternatively,
if a custom <code>loss</code> was set, it will can be used
in arbitrary ways.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_names</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of names for the variables, rather than "x0", "x1", etc.
If <code>X</code> is a pandas dataframe, the column names will be used
instead of <code>variable_names</code>. Cannot contain spaces or special
characters. Avoid variable names which are also
function names in <code>sympy</code>, such as "N".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_units</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of units for each variable in <code>X</code>. Each unit should be
a string representing a Julia expression. See DynamicQuantities.jl
https://symbolicml.org/DynamicQuantities.jl/dev/units/ for more
information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_units</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similar to <code>X_units</code>, but as a unit for the target variable, <code>y</code>.
If <code>y</code> is a matrix, a list of units should be passed. If <code>X_units</code>
is given but <code>y_units</code> is not, then <code>y_units</code> will be arbitrary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>expression_spec</code> is a <code>ParametricExpressionSpec</code>, then this
argument should be a list of integers representing the category
of each sample.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted estimator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2305" name="__codelineno-0-2305"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>    <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>    <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>    <span class="n">Xresampled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>    <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>    <span class="n">variable_names</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>    <span class="n">complexity_of_variables</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>    <span class="n">X_units</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>    <span class="n">y_units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>    <span class="n">category</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PySRRegressor&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a><span class="sd">    Search for equations to fit the dataset and store them in `self.equations_`.</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a><span class="sd">    X : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a><span class="sd">        Training data of shape (n_samples, n_features).</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a><span class="sd">    y : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a><span class="sd">        Target values of shape (n_samples,) or (n_samples, n_targets).</span>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a><span class="sd">        Will be cast to X&#39;s dtype if necessary.</span>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a><span class="sd">    Xresampled : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><span class="sd">        Resampled training data, of shape (n_resampled, n_features),</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><span class="sd">        to generate a denoised data on. This</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a><span class="sd">        will be used as the training data, rather than `X`.</span>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><span class="sd">    weights : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><span class="sd">        Weight array of the same shape as `y`.</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a><span class="sd">        Each element is how to weight the mean-square-error loss</span>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="sd">        for that particular element of `y`. Alternatively,</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">        if a custom `loss` was set, it will can be used</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a><span class="sd">        in arbitrary ways.</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">    variable_names : list[str]</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">        A list of names for the variables, rather than &quot;x0&quot;, &quot;x1&quot;, etc.</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><span class="sd">        If `X` is a pandas dataframe, the column names will be used</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><span class="sd">        instead of `variable_names`. Cannot contain spaces or special</span>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a><span class="sd">        characters. Avoid variable names which are also</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><span class="sd">        function names in `sympy`, such as &quot;N&quot;.</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a><span class="sd">    X_units : list[str]</span>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a><span class="sd">        A list of units for each variable in `X`. Each unit should be</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a><span class="sd">        a string representing a Julia expression. See DynamicQuantities.jl</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="sd">        https://symbolicml.org/DynamicQuantities.jl/dev/units/ for more</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a><span class="sd">        information.</span>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a><span class="sd">    y_units : str | list[str]</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="sd">        Similar to `X_units`, but as a unit for the target variable, `y`.</span>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="sd">        If `y` is a matrix, a list of units should be passed. If `X_units`</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="sd">        is given but `y_units` is not, then `y_units` will be arbitrary.</span>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a><span class="sd">    category : list[int]</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><span class="sd">        If `expression_spec` is a `ParametricExpressionSpec`, then this</span>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="sd">        argument should be a list of integers representing the category</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a><span class="sd">        of each sample.</span>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">    self : object</span>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><span class="sd">        Fitted estimator.</span>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a>    <span class="c1"># Init attributes that are not specified in BaseEstimator</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;julia_state_stream_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;julia_state_stream_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a>                <span class="s2">&quot;The discovered expressions are being reset. &quot;</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a>                <span class="s2">&quot;Please set `warm_start=True` if you wish to continue &quot;</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a>                <span class="s2">&quot;to start a search where you left off.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>            <span class="p">)</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">julia_state_stream_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">julia_options_stream_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">complexity_of_variables_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_units_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_units_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_equation_file</span><span class="p">()</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_clear_equation_file_contents</span><span class="p">()</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>    <span class="n">runtime_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_modify_params</span><span class="p">()</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>    <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>        <span class="k">assert</span> <span class="n">Xresampled</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec</span><span class="p">,</span> <span class="n">ParametricExpressionSpec</span><span class="p">):</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>        <span class="k">assert</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>    <span class="c1"># TODO: Put `category` here</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>    <span class="p">(</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>        <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_set_fit_params</span><span class="p">(</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>        <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>    <span class="p">)</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>            <span class="s2">&quot;You are using a dataset with more than 50,000 datapoints. &quot;</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>            <span class="s2">&quot;Symbolic regression rarely benefits from this many points - consider &quot;</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>            <span class="s2">&quot;subsampling to 10,000 points or fewer. If you have high noise, &quot;</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>            <span class="s2">&quot;denoise the data first rather than using more points.&quot;</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>        <span class="p">)</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>    <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>  <span class="c1"># For np random</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>    <span class="n">seed</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># For julia random</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec</span><span class="p">,</span> <span class="n">ParametricExpressionSpec</span><span class="p">):</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>        <span class="n">parametric_expression_deprecation_warning</span><span class="p">(</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec</span><span class="o">.</span><span class="n">max_parameters</span><span class="p">,</span> <span class="n">variable_names</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>        <span class="p">)</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>    <span class="c1"># Pre transformations (feature selection and denoising)</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">variable_names</span><span class="p">,</span> <span class="n">complexity_of_variables</span><span class="p">,</span> <span class="n">X_units</span><span class="p">,</span> <span class="n">y_units</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_transform_training_data</span><span class="p">(</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>            <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>            <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>            <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>            <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>            <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>            <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>            <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>            <span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>        <span class="p">)</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>    <span class="p">)</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>    <span class="c1"># Assertion checks</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>    <span class="n">use_custom_variable_names</span> <span class="o">=</span> <span class="n">variable_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>    <span class="c1"># TODO: this is always true.</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>    <span class="n">_check_assertions</span><span class="p">(</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>        <span class="n">use_custom_variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>    <span class="p">)</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>    <span class="c1"># Initially, just save model parameters, so that</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>    <span class="c1"># it can be loaded from an early exit:</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_equation_file</span><span class="p">:</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">()</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>    <span class="c1"># Perform the search:</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">runtime_params</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>    <span class="c1"># Then, after fit, we save again, so the pickle file contains</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>    <span class="c1"># the equations:</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_equation_file</span><span class="p">:</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">()</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Predict y from input X using the equation chosen by <code>model_selection</code>.</p>
<p>You may see what equation is used by printing this object. X should
have the same columns as the training data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data of shape <code>(n_samples, n_features)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you want to compute the output of an expression using a
particular row of <code>self.equations_</code>, you may specify the index here.
For multiple output equations, you must pass a list of indices
in the same order.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>category</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>expression_spec</code> is a <code>ParametricExpressionSpec</code>, then this
argument should be a list of integers representing the category
of each sample in <code>X</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>y_predicted</code></td>            <td>
                  <code>ndarray of shape (n_samples, nout_)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values predicted by substituting <code>X</code> into the fitted symbolic
regression model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raises if the <code>best_equation</code> cannot be evaluated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2495" name="__codelineno-0-2495"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>    <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>    <span class="n">category</span><span class="p">:</span> <span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">    Predict y from input X using the equation chosen by `model_selection`.</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">    You may see what equation is used by printing this object. X should</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">    have the same columns as the training data.</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a><span class="sd">    X : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a><span class="sd">        Training data of shape `(n_samples, n_features)`.</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a><span class="sd">        If you want to compute the output of an expression using a</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a><span class="sd">        particular row of `self.equations_`, you may specify the index here.</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><span class="sd">        For multiple output equations, you must pass a list of indices</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="sd">        in the same order.</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="sd">    category : ndarray | None</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><span class="sd">        If `expression_spec` is a `ParametricExpressionSpec`, then this</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a><span class="sd">        argument should be a list of integers representing the category</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><span class="sd">        of each sample in `X`.</span>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a><span class="sd">    y_predicted : ndarray of shape (n_samples, nout_)</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><span class="sd">        Values predicted by substituting `X` into the fitted symbolic</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><span class="sd">        regression model.</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><span class="sd">    ------</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a><span class="sd">        Raises if the `best_equation` cannot be evaluated.</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>    <span class="n">check_is_fitted</span><span class="p">(</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selection_mask_&quot;</span><span class="p">,</span> <span class="s2">&quot;feature_names_in_&quot;</span><span class="p">,</span> <span class="s2">&quot;nout_&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>    <span class="p">)</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>    <span class="c1"># When X is an numpy array or a pandas dataframe with a RangeIndex,</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>    <span class="c1"># the self.feature_names_in_ generated during fit, for the same X,</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>    <span class="c1"># will cause a warning to be thrown during _validate_data.</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>    <span class="c1"># To avoid this, convert X to a dataframe, apply the selection mask,</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>    <span class="c1"># and then set the column/feature_names of X to be equal to those</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>    <span class="c1"># generated during fit.</span>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">check_array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>            <span class="c1"># RangeIndex enforces column order allowing columns to</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>            <span class="c1"># be correctly filtered with self.selection_mask_</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span><span class="p">]]</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>        <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_names_in_</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>    <span class="c1"># Without feature information, CallableEquation/lambda_format equations</span>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>    <span class="c1"># require that the column order of X matches that of the X used during</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>    <span class="c1"># the fitting process. _validate_data removes this feature information</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>    <span class="c1"># when it converts the dataframe to an np array. Thus, to ensure feature</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>    <span class="c1"># order is preserved after conversion, the dataframe columns must be</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>    <span class="c1"># reordered/reindexed to match those of the transformed (denoised and</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>    <span class="c1"># feature selected) X in fit.</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data_X</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">evaluates_in_julia</span><span class="p">:</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>        <span class="c1"># Julia wants the right dtype</span>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_precision_mapped_dtype</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>    <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>        <span class="n">offset_for_julia_indexing</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>            <span class="n">jl_array</span><span class="p">((</span><span class="n">category</span> <span class="o">+</span> <span class="n">offset_for_julia_indexing</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)),</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>        <span class="p">)</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">()</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>                <span class="p">[</span>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>                    <span class="n">cast</span><span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">eq</span><span class="p">[</span><span class="s2">&quot;lambda_format&quot;</span><span class="p">](</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>                    <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>                <span class="p">],</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>            <span class="p">)</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2585" name="__codelineno-0-2585"></a>            <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;lambda_format&quot;</span><span class="p">](</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
<a id="__codelineno-0-2586" name="__codelineno-0-2586"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-2587" name="__codelineno-0-2587"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2588" name="__codelineno-0-2588"></a>            <span class="s2">&quot;Failed to evaluate the expression. &quot;</span>
<a id="__codelineno-0-2589" name="__codelineno-0-2589"></a>            <span class="s2">&quot;If you are using a custom operator, make sure to define it in `extra_sympy_mappings`, &quot;</span>
<a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>            <span class="s2">&quot;e.g., `model.set_params(extra_sympy_mappings={&#39;inv&#39;: lambda x: 1/x})`, where &quot;</span>
<a id="__codelineno-0-2591" name="__codelineno-0-2591"></a>            <span class="s2">&quot;`lambda x: 1/x` is a valid SymPy function defining the operator. &quot;</span>
<a id="__codelineno-0-2592" name="__codelineno-0-2592"></a>            <span class="s2">&quot;You can then run `model.refresh()` to re-load the expressions.&quot;</span>
<a id="__codelineno-0-2593" name="__codelineno-0-2593"></a>        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">error</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_file</span><span class="p">(</span><span class="n">equation_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">run_directory</span><span class="p">,</span> <span class="n">binary_operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unary_operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_features_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feature_names_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selection_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pysr.PySRRegressor.from_file" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Create a model from a saved model checkpoint or equation file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>run_directory</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory containing outputs from a previous run.
This is of the form <code>[output_directory]/[run_id]</code>.
Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binary_operators</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The same binary operators used when creating the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unary_operators</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The same unary operators used when creating the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operators</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="int">int</span>, <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Operator mapping by arity used when creating the model. Provide this if the
original run relied on the generic <code>operators</code> parameter. Not needed if
loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_features_in</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of features passed to the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_names_in</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the features passed to the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_mask</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If using <code>select_k_features</code>, you must pass <code>model.selection_mask_</code> here.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nout</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of outputs of the model.
Not needed if loading from a pickle file.
Default is <code>1</code>.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**pysr_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any other keyword arguments to initialize the PySRRegressor object.
These will overwrite those stored in the pickle file.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>model</code></td>            <td>
                  <code><span title="pysr.sr.PySRRegressor">PySRRegressor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model with fitted equations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>    <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>    <span class="n">equation_file</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Deprecated</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>    <span class="n">run_directory</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>    <span class="n">binary_operators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>    <span class="n">unary_operators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>    <span class="n">operators</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>    <span class="n">n_features_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>    <span class="n">feature_names_in</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>    <span class="n">selection_mask</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>    <span class="n">nout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>    <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PySRRegressor&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">    Create a model from a saved model checkpoint or equation file.</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">    run_directory : str</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">        The directory containing outputs from a previous run.</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">        This is of the form `[output_directory]/[run_id]`.</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">        Default is `None`.</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">    binary_operators : list[str]</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">        The same binary operators used when creating the model.</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">    unary_operators : list[str]</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">        The same unary operators used when creating the model.</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">    operators : dict[int, list[str]]</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">        Operator mapping by arity used when creating the model. Provide this if the</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">        original run relied on the generic `operators` parameter. Not needed if</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">        loading from a pickle file.</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">    n_features_in : int</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">        Number of features passed to the model.</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">    feature_names_in : list[str]</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">        Names of the features passed to the model.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">    selection_mask : NDArray[np.bool_]</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">        If using `select_k_features`, you must pass `model.selection_mask_` here.</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">    nout : int</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">        Number of outputs of the model.</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><span class="sd">        Default is `1`.</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">    **pysr_kwargs : dict</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><span class="sd">        Any other keyword arguments to initialize the PySRRegressor object.</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">        These will overwrite those stored in the pickle file.</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">    model : PySRRegressor</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">        The model with fitted equations.</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="k">if</span> <span class="n">equation_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>            <span class="s2">&quot;Passing `equation_file` is deprecated and no longer compatible with &quot;</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="s2">&quot;the most recent versions of PySR&#39;s backend. Please pass `run_directory` &quot;</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>            <span class="s2">&quot;instead, which contains all checkpoint files.&quot;</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>        <span class="p">)</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="n">pkl_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;checkpoint.pkl&quot;</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="k">if</span> <span class="n">pkl_filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>        <span class="n">pysr_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to load model from </span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="k">assert</span> <span class="n">binary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>        <span class="k">assert</span> <span class="n">unary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="k">assert</span> <span class="n">operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>        <span class="k">assert</span> <span class="n">n_features_in</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;PySRRegressor&quot;</span><span class="p">,</span> <span class="n">pkl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>        <span class="c1"># Update any parameters if necessary, such as</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="c1"># extra_sympy_mappings:</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="k">if</span> <span class="s2">&quot;equations_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="vm">__dict__</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">equations_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>            <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">expression_spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>                <span class="s2">&quot;Loading model from checkpoint file with a non-default expression spec &quot;</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>                <span class="s2">&quot;is not fully supported as it relies on dynamic objects. This may result in unexpected behavior.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>            <span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="k">return</span> <span class="n">model</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>        <span class="n">pysr_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>            <span class="sa">f</span><span class="s2">&quot;Checkpoint file </span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2"> does not exist. &quot;</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>            <span class="s2">&quot;Attempting to recreate model from scratch...&quot;</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>        <span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>        <span class="n">csv_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;hall_of_fame.csv&quot;</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="n">csv_filename_bak</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;hall_of_fame.csv.bak&quot;</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">csv_filename</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">csv_filename_bak</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>                <span class="sa">f</span><span class="s2">&quot;Hall of fame file `</span><span class="si">{</span><span class="n">csv_filename</span><span class="si">}</span><span class="s2">` or `</span><span class="si">{</span><span class="n">csv_filename_bak</span><span class="si">}</span><span class="s2">` does not exist. &quot;</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>                <span class="s2">&quot;Please pass a `run_directory` containing a valid checkpoint file.&quot;</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>            <span class="p">)</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>            <span class="n">operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>            <span class="ow">and</span> <span class="n">binary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>            <span class="ow">and</span> <span class="n">unary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>        <span class="p">):</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                <span class="s2">&quot;When recreating a model from CSV backups you must provide either &quot;</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>                <span class="s2">&quot;`operators` or legacy `binary_operators`/`unary_operators`.&quot;</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>            <span class="p">)</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>        <span class="k">assert</span> <span class="n">n_features_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>        <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>            <span class="n">binary_operators</span><span class="o">=</span><span class="n">binary_operators</span><span class="p">,</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>            <span class="n">unary_operators</span><span class="o">=</span><span class="n">unary_operators</span><span class="p">,</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>            <span class="n">operators</span><span class="o">=</span><span class="n">operators</span><span class="p">,</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>            <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>        <span class="p">)</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>        <span class="n">model</span><span class="o">.</span><span class="n">nout_</span> <span class="o">=</span> <span class="n">nout</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>        <span class="n">model</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">=</span> <span class="n">n_features_in</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>        <span class="k">if</span> <span class="n">feature_names_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>            <span class="n">model</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">)]</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>            <span class="p">)</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>            <span class="n">model</span><span class="o">.</span><span class="n">display_feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>                <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">_subscriptify</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">)]</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>            <span class="p">)</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_in</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_features_in</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>            <span class="n">model</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">feature_names_in</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>            <span class="n">model</span><span class="o">.</span><span class="n">display_feature_names_in_</span> <span class="o">=</span> <span class="n">feature_names_in</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="k">if</span> <span class="n">selection_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>            <span class="n">model</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>            <span class="n">model</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="n">selection_mask</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>        <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">run_directory</span><span class="o">=</span><span class="n">run_directory</span><span class="p">)</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>        <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.sympy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sympy</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.sympy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return sympy representation of the equation(s) chosen by <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>str, list[str] of length nout_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SymPy representation of the best equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2595" name="__codelineno-0-2595"></a><span class="k">def</span><span class="w"> </span><span class="nf">sympy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2596" name="__codelineno-0-2596"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2597" name="__codelineno-0-2597"></a><span class="sd">    Return sympy representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2598" name="__codelineno-0-2598"></a>
<a id="__codelineno-0-2599" name="__codelineno-0-2599"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2600" name="__codelineno-0-2600"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2601" name="__codelineno-0-2601"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2602" name="__codelineno-0-2602"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2603" name="__codelineno-0-2603"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2604" name="__codelineno-0-2604"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2607" name="__codelineno-0-2607"></a>
<a id="__codelineno-0-2608" name="__codelineno-0-2608"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2609" name="__codelineno-0-2609"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2610" name="__codelineno-0-2610"></a><span class="sd">    best_equation : str, list[str] of length nout_</span>
<a id="__codelineno-0-2611" name="__codelineno-0-2611"></a><span class="sd">        SymPy representation of the best equation.</span>
<a id="__codelineno-0-2612" name="__codelineno-0-2612"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_sympy</span><span class="p">:</span>
<a id="__codelineno-0-2614" name="__codelineno-0-2614"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2615" name="__codelineno-0-2615"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support sympy export.&quot;</span>
<a id="__codelineno-0-2616" name="__codelineno-0-2616"></a>        <span class="p">)</span>
<a id="__codelineno-0-2617" name="__codelineno-0-2617"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2619" name="__codelineno-0-2619"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2620" name="__codelineno-0-2620"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2621" name="__codelineno-0-2621"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;sympy_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2622" name="__codelineno-0-2622"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2623" name="__codelineno-0-2623"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;sympy_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.latex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.latex" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return latex representation of the equation(s) chosen by <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of significant figures shown in the LaTeX
representation.
Default is <code>3</code>.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>str or list[str] of length nout_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LaTeX expression of the best equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2625" name="__codelineno-0-2625"></a><span class="k">def</span><span class="w"> </span><span class="nf">latex</span><span class="p">(</span>
<a id="__codelineno-0-2626" name="__codelineno-0-2626"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-2627" name="__codelineno-0-2627"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2628" name="__codelineno-0-2628"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2629" name="__codelineno-0-2629"></a><span class="sd">    Return latex representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>
<a id="__codelineno-0-2631" name="__codelineno-0-2631"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2632" name="__codelineno-0-2632"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2633" name="__codelineno-0-2633"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2634" name="__codelineno-0-2634"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2635" name="__codelineno-0-2635"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2636" name="__codelineno-0-2636"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2637" name="__codelineno-0-2637"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2638" name="__codelineno-0-2638"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2639" name="__codelineno-0-2639"></a><span class="sd">    precision : int</span>
<a id="__codelineno-0-2640" name="__codelineno-0-2640"></a><span class="sd">        The number of significant figures shown in the LaTeX</span>
<a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="sd">        representation.</span>
<a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="sd">        Default is `3`.</span>
<a id="__codelineno-0-2643" name="__codelineno-0-2643"></a>
<a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2646" name="__codelineno-0-2646"></a><span class="sd">    best_equation : str or list[str] of length nout_</span>
<a id="__codelineno-0-2647" name="__codelineno-0-2647"></a><span class="sd">        LaTeX expression of the best equation.</span>
<a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2649" name="__codelineno-0-2649"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_latex</span><span class="p">:</span>
<a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2651" name="__codelineno-0-2651"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support latex export.&quot;</span>
<a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>        <span class="p">)</span>
<a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>    <span class="n">sympy_representation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sympy</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sympy_representation</span><span class="p">:</span>
<a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>            <span class="n">latex</span> <span class="o">=</span> <span class="n">sympy2latex</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">latex</span><span class="p">)</span>
<a id="__codelineno-0-2660" name="__codelineno-0-2660"></a>        <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>    <span class="k">return</span> <span class="n">sympy2latex</span><span class="p">(</span><span class="n">sympy_representation</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.pytorch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pytorch</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.pytorch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return pytorch representation of the equation(s) chosen by <code>model_selection</code>.</p>
<p>Each equation (multiple given if there are multiple outputs) is a PyTorch module
containing the parameters as trainable attributes. You can use the module like
any other PyTorch module: <code>module(X)</code>, where <code>X</code> is a tensor with the same
column ordering as trained with.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PyTorch module representing the expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2699" name="__codelineno-0-2699"></a><span class="k">def</span><span class="w"> </span><span class="nf">pytorch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a><span class="sd">    Return pytorch representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a><span class="sd">    Each equation (multiple given if there are multiple outputs) is a PyTorch module</span>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a><span class="sd">    containing the parameters as trainable attributes. You can use the module like</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a><span class="sd">    any other PyTorch module: `module(X)`, where `X` is a tensor with the same</span>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a><span class="sd">    column ordering as trained with.</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2710" name="__codelineno-0-2710"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2711" name="__codelineno-0-2711"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2715" name="__codelineno-0-2715"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>
<a id="__codelineno-0-2717" name="__codelineno-0-2717"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2718" name="__codelineno-0-2718"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2719" name="__codelineno-0-2719"></a><span class="sd">    best_equation : torch.nn.Module</span>
<a id="__codelineno-0-2720" name="__codelineno-0-2720"></a><span class="sd">        PyTorch module representing the expression.</span>
<a id="__codelineno-0-2721" name="__codelineno-0-2721"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_torch</span><span class="p">:</span>
<a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support torch export.&quot;</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a>        <span class="p">)</span>
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">output_torch_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;torch_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;torch_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.jax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jax</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.jax" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return jax representation of the equation(s) chosen by <code>model_selection</code>.</p>
<p>Each equation (multiple given if there are multiple outputs) is a dictionary
containing {"callable": func, "parameters": params}. To call <code>func</code>, pass
func(X, params). This function is differentiable using <code>jax.grad</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of callable jax function in "callable" key,
and jax array of parameters as "parameters" key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2663" name="__codelineno-0-2663"></a><span class="k">def</span><span class="w"> </span><span class="nf">jax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2664" name="__codelineno-0-2664"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="sd">    Return jax representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>
<a id="__codelineno-0-2667" name="__codelineno-0-2667"></a><span class="sd">    Each equation (multiple given if there are multiple outputs) is a dictionary</span>
<a id="__codelineno-0-2668" name="__codelineno-0-2668"></a><span class="sd">    containing {&quot;callable&quot;: func, &quot;parameters&quot;: params}. To call `func`, pass</span>
<a id="__codelineno-0-2669" name="__codelineno-0-2669"></a><span class="sd">    func(X, params). This function is differentiable using `jax.grad`.</span>
<a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>
<a id="__codelineno-0-2671" name="__codelineno-0-2671"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2673" name="__codelineno-0-2673"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2675" name="__codelineno-0-2675"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2676" name="__codelineno-0-2676"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2678" name="__codelineno-0-2678"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>
<a id="__codelineno-0-2680" name="__codelineno-0-2680"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2681" name="__codelineno-0-2681"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="sd">    best_equation : dict[str, Any]</span>
<a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">        Dictionary of callable jax function in &quot;callable&quot; key,</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">        and jax array of parameters as &quot;parameters&quot; key.</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_jax</span><span class="p">:</span>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support jax export.&quot;</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>        <span class="p">)</span>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">output_jax_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;jax_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2696" name="__codelineno-0-2696"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2697" name="__codelineno-0-2697"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;jax_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.latex_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latex_table</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;equation&#39;</span><span class="p">,</span> <span class="s1">&#39;complexity&#39;</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">])</span></code>

<a href="#pysr.PySRRegressor.latex_table" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Create a LaTeX/booktabs table for all, or some, of the equations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>indices</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="list">list</span>[<span title="list">list</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular subset of equations from
<code>self.equations_</code>, give the row numbers here. By default,
all equations will be used. If there are multiple output
features, then pass a list of lists.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of significant figures shown in the LaTeX
representations.
Default is <code>3</code>.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which columns to include in the table.
Default is <code>["equation", "complexity", "loss", "score"]</code>.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;equation&#39;, &#39;complexity&#39;, &#39;loss&#39;, &#39;score&#39;]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>latex_table_str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string that will render a table in LaTeX of the equations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span>
<span class="normal"><a href="#__codelineno-0-2837">2837</a></span>
<span class="normal"><a href="#__codelineno-0-2838">2838</a></span>
<span class="normal"><a href="#__codelineno-0-2839">2839</a></span>
<span class="normal"><a href="#__codelineno-0-2840">2840</a></span>
<span class="normal"><a href="#__codelineno-0-2841">2841</a></span>
<span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span>
<span class="normal"><a href="#__codelineno-0-2851">2851</a></span>
<span class="normal"><a href="#__codelineno-0-2852">2852</a></span>
<span class="normal"><a href="#__codelineno-0-2853">2853</a></span>
<span class="normal"><a href="#__codelineno-0-2854">2854</a></span>
<span class="normal"><a href="#__codelineno-0-2855">2855</a></span>
<span class="normal"><a href="#__codelineno-0-2856">2856</a></span>
<span class="normal"><a href="#__codelineno-0-2857">2857</a></span>
<span class="normal"><a href="#__codelineno-0-2858">2858</a></span>
<span class="normal"><a href="#__codelineno-0-2859">2859</a></span>
<span class="normal"><a href="#__codelineno-0-2860">2860</a></span>
<span class="normal"><a href="#__codelineno-0-2861">2861</a></span>
<span class="normal"><a href="#__codelineno-0-2862">2862</a></span>
<span class="normal"><a href="#__codelineno-0-2863">2863</a></span>
<span class="normal"><a href="#__codelineno-0-2864">2864</a></span>
<span class="normal"><a href="#__codelineno-0-2865">2865</a></span>
<span class="normal"><a href="#__codelineno-0-2866">2866</a></span>
<span class="normal"><a href="#__codelineno-0-2867">2867</a></span>
<span class="normal"><a href="#__codelineno-0-2868">2868</a></span>
<span class="normal"><a href="#__codelineno-0-2869">2869</a></span>
<span class="normal"><a href="#__codelineno-0-2870">2870</a></span>
<span class="normal"><a href="#__codelineno-0-2871">2871</a></span>
<span class="normal"><a href="#__codelineno-0-2872">2872</a></span>
<span class="normal"><a href="#__codelineno-0-2873">2873</a></span>
<span class="normal"><a href="#__codelineno-0-2874">2874</a></span>
<span class="normal"><a href="#__codelineno-0-2875">2875</a></span>
<span class="normal"><a href="#__codelineno-0-2876">2876</a></span>
<span class="normal"><a href="#__codelineno-0-2877">2877</a></span>
<span class="normal"><a href="#__codelineno-0-2878">2878</a></span>
<span class="normal"><a href="#__codelineno-0-2879">2879</a></span>
<span class="normal"><a href="#__codelineno-0-2880">2880</a></span>
<span class="normal"><a href="#__codelineno-0-2881">2881</a></span>
<span class="normal"><a href="#__codelineno-0-2882">2882</a></span>
<span class="normal"><a href="#__codelineno-0-2883">2883</a></span>
<span class="normal"><a href="#__codelineno-0-2884">2884</a></span>
<span class="normal"><a href="#__codelineno-0-2885">2885</a></span>
<span class="normal"><a href="#__codelineno-0-2886">2886</a></span>
<span class="normal"><a href="#__codelineno-0-2887">2887</a></span>
<span class="normal"><a href="#__codelineno-0-2888">2888</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2831" name="__codelineno-0-2831"></a><span class="k">def</span><span class="w"> </span><span class="nf">latex_table</span><span class="p">(</span>
<a id="__codelineno-0-2832" name="__codelineno-0-2832"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2833" name="__codelineno-0-2833"></a>    <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2834" name="__codelineno-0-2834"></a>    <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-2835" name="__codelineno-0-2835"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;equation&quot;</span><span class="p">,</span> <span class="s2">&quot;complexity&quot;</span><span class="p">,</span> <span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">],</span>
<a id="__codelineno-0-2836" name="__codelineno-0-2836"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2837" name="__codelineno-0-2837"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a LaTeX/booktabs table for all, or some, of the equations.</span>
<a id="__codelineno-0-2838" name="__codelineno-0-2838"></a>
<a id="__codelineno-0-2839" name="__codelineno-0-2839"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2840" name="__codelineno-0-2840"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2841" name="__codelineno-0-2841"></a><span class="sd">    indices : list[int] | list[list[int]]</span>
<a id="__codelineno-0-2842" name="__codelineno-0-2842"></a><span class="sd">        If you wish to select a particular subset of equations from</span>
<a id="__codelineno-0-2843" name="__codelineno-0-2843"></a><span class="sd">        `self.equations_`, give the row numbers here. By default,</span>
<a id="__codelineno-0-2844" name="__codelineno-0-2844"></a><span class="sd">        all equations will be used. If there are multiple output</span>
<a id="__codelineno-0-2845" name="__codelineno-0-2845"></a><span class="sd">        features, then pass a list of lists.</span>
<a id="__codelineno-0-2846" name="__codelineno-0-2846"></a><span class="sd">    precision : int</span>
<a id="__codelineno-0-2847" name="__codelineno-0-2847"></a><span class="sd">        The number of significant figures shown in the LaTeX</span>
<a id="__codelineno-0-2848" name="__codelineno-0-2848"></a><span class="sd">        representations.</span>
<a id="__codelineno-0-2849" name="__codelineno-0-2849"></a><span class="sd">        Default is `3`.</span>
<a id="__codelineno-0-2850" name="__codelineno-0-2850"></a><span class="sd">    columns : list[str]</span>
<a id="__codelineno-0-2851" name="__codelineno-0-2851"></a><span class="sd">        Which columns to include in the table.</span>
<a id="__codelineno-0-2852" name="__codelineno-0-2852"></a><span class="sd">        Default is `[&quot;equation&quot;, &quot;complexity&quot;, &quot;loss&quot;, &quot;score&quot;]`.</span>
<a id="__codelineno-0-2853" name="__codelineno-0-2853"></a>
<a id="__codelineno-0-2854" name="__codelineno-0-2854"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2855" name="__codelineno-0-2855"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2856" name="__codelineno-0-2856"></a><span class="sd">    latex_table_str : str</span>
<a id="__codelineno-0-2857" name="__codelineno-0-2857"></a><span class="sd">        A string that will render a table in LaTeX of the equations.</span>
<a id="__codelineno-0-2858" name="__codelineno-0-2858"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2859" name="__codelineno-0-2859"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="o">.</span><span class="n">supports_latex</span><span class="p">:</span>
<a id="__codelineno-0-2860" name="__codelineno-0-2860"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2861" name="__codelineno-0-2861"></a>            <span class="sa">f</span><span class="s2">&quot;`expression_spec=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">expression_spec_</span><span class="si">}</span><span class="s2">` does not support latex export.&quot;</span>
<a id="__codelineno-0-2862" name="__codelineno-0-2862"></a>        <span class="p">)</span>
<a id="__codelineno-0-2863" name="__codelineno-0-2863"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2864" name="__codelineno-0-2864"></a>
<a id="__codelineno-0-2865" name="__codelineno-0-2865"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2866" name="__codelineno-0-2866"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2867" name="__codelineno-0-2867"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2868" name="__codelineno-0-2868"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2869" name="__codelineno-0-2869"></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span>
<a id="__codelineno-0-2870" name="__codelineno-0-2870"></a>
<a id="__codelineno-0-2871" name="__codelineno-0-2871"></a>        <span class="n">table_string</span> <span class="o">=</span> <span class="n">sympy2multilatextable</span><span class="p">(</span>
<a id="__codelineno-0-2872" name="__codelineno-0-2872"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<a id="__codelineno-0-2873" name="__codelineno-0-2873"></a>        <span class="p">)</span>
<a id="__codelineno-0-2874" name="__codelineno-0-2874"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-2875" name="__codelineno-0-2875"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2876" name="__codelineno-0-2876"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2877" name="__codelineno-0-2877"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2878" name="__codelineno-0-2878"></a>
<a id="__codelineno-0-2879" name="__codelineno-0-2879"></a>        <span class="n">table_string</span> <span class="o">=</span> <span class="n">sympy2latextable</span><span class="p">(</span>
<a id="__codelineno-0-2880" name="__codelineno-0-2880"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<a id="__codelineno-0-2881" name="__codelineno-0-2881"></a>        <span class="p">)</span>
<a id="__codelineno-0-2882" name="__codelineno-0-2882"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2883" name="__codelineno-0-2883"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2884" name="__codelineno-0-2884"></a>            <span class="s2">&quot;Invalid type for equations_ to pass to `latex_table`. &quot;</span>
<a id="__codelineno-0-2885" name="__codelineno-0-2885"></a>            <span class="s2">&quot;Expected a DataFrame or a list of DataFrames.&quot;</span>
<a id="__codelineno-0-2886" name="__codelineno-0-2886"></a>        <span class="p">)</span>
<a id="__codelineno-0-2887" name="__codelineno-0-2887"></a>
<a id="__codelineno-0-2888" name="__codelineno-0-2888"></a>    <span class="k">return</span> <span class="n">with_preamble</span><span class="p">(</span><span class="n">table_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.refresh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">refresh</span><span class="p">(</span><span class="n">run_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.refresh" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Update self.equations_ with any new options passed.</p>
<p>For example, updating <code>extra_sympy_mappings</code>
will require a <code>.refresh()</code> to update the equations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>checkpoint_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to checkpoint hall of fame file to be loaded.
The default will use the set <code>equation_file_</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2475" name="__codelineno-0-2475"></a><span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_directory</span><span class="p">:</span> <span class="n">PathLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a><span class="sd">    Update self.equations_ with any new options passed.</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a><span class="sd">    For example, updating `extra_sympy_mappings`</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a><span class="sd">    will require a `.refresh()` to update the equations.</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a><span class="sd">    checkpoint_file : str or Path</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a><span class="sd">        Path to checkpoint hall of fame file to be loaded.</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a><span class="sd">        The default will use the set `equation_file_`.</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>    <span class="k">if</span> <span class="n">run_directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_directory_</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run_id_</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">run_directory</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_equation_file_contents</span><span class="p">()</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>    <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;run_id_&quot;</span><span class="p">,</span> <span class="s2">&quot;output_directory_&quot;</span><span class="p">])</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hof</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="expression-specifications">Expression Specifications<a class="headerlink" href="#expression-specifications" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="pysr.ExpressionSpec" class="doc doc-heading">
            <code>ExpressionSpec</code>


<a href="#pysr.ExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>The default expression specification, with no special behavior.</p>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.TemplateExpressionSpec" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TemplateExpressionSpec</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pysr.TemplateExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>
              <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">TemplateExpressionSpec</span><span class="p">(</span><span class="n">function_symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">combine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_features</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">TemplateExpressionSpec</span><span class="p">(</span><span class="n">combine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">expressions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">variable_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>              </div>


    <div class="doc doc-contents first">


        <p>Spec for templated expressions.</p>
<p>This class allows you to specify how multiple sub-expressions should be combined
in a structured way, with constraints on which variables each sub-expression can use.
Pass this to PySRRegressor with the <code>expression_spec</code> argument.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>combine</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Julia function string that defines how the sub-expressions are combined.
For example: "sin(f(x1, x2)) + g(x3)^2" would constrain f to use x1,x2 and g to use x3.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expressions</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of symbols representing the inner expressions (e.g., ["f", "g"]).
These will be used as keys in the template structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_names</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variable names that will be used in the combine function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping parameter names to their lengths. For example, {"p1": 2, "p2": 1}
means p1 is a vector of length 2 and p2 is a vector of length 1. These parameters
will be optimized during the search.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Create template that combines f(x1, x2) and g(x3):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">expression_spec</span> <span class="o">=</span> <span class="n">TemplateExpressionSpec</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">variable_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;sin(f(x1, x2)) + g(x3)^2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># With parameters:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">expression_spec</span> <span class="o">=</span> <span class="n">TemplateExpressionSpec</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">expressions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">variable_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">,</span> <span class="s2">&quot;x3&quot;</span><span class="p">],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;p1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;p2&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;p1[1] * sin(f(x1, x2)) + p1[2] * g(x3) + p2[1]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Use in PySRRegressor:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">expression_spec</span><span class="o">=</span><span class="n">expression_spec</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="p">)</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>You can also use differential operators in the template with <code>D(f, 1)(x)</code> to take
the derivative of f with respect to its first argument, evaluated at x.</p>
</details>
        <p>Handle both formats with combine as explicit parameter</p>








                  <details class="quote">
                    <summary>Source code in <code>pysr/expression_specs.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="p">):</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle both formats with combine as explicit parameter&quot;&quot;&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_old_format</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="s2">&quot;function_symbols&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_format</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_load_old_format</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_load_new_format</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.ParametricExpressionSpec" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ParametricExpressionSpec</span><span class="p">(</span><span class="n">max_parameters</span><span class="p">)</span></code>

<a href="#pysr.ParametricExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Spec for parametric expressions that vary by category.</p>
<p><strong>This is deprecated in favor of the <code>TemplateExpressionSpec</code> class,
which now supports parameters indexed by category.</strong></p>
<p>This class allows you to specify expressions with parameters that vary across different
categories in your dataset. The expression structure remains the same, but parameters
are optimized separately for each category.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>max_parameters</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of parameters that can appear in the expression. Each parameter
will take on different values for each category in the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>For example, if we want to allow for a model with up to 2 parameters (each category
can have a different value for these parameters), we can use:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">PySRRegressor</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">expression_spec</span><span class="o">=</span><span class="n">ParametricExpressionSpec</span><span class="p">(</span><span class="n">max_parameters</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">binary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">unary_operators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>pysr/expression_specs.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_parameters</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_parameters</span> <span class="o">=</span> <span class="n">max_parameters</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.AbstractExpressionSpec" class="doc doc-heading">
            <code>AbstractExpressionSpec</code>


<a href="#pysr.AbstractExpressionSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Abstract base class describing expression types.</p>
<p>This basically just holds the options for the expression type,
as well as explains how to parse and evaluate them.</p>
<p>All expression types must implement:</p>
<ol>
<li>julia_expression_spec(): The actual expression specification, returned as a Julia object.
    This will get passed as <code>expression_spec</code> in <code>SymbolicRegression.Options</code>.</li>
<li>create_exports(), which will be used to create the exports of the equations, such as
    the executable format, the SymPy format, etc.</li>
</ol>
<p>It may also optionally implement:</p>
<ul>
<li>supports_sympy, supports_torch, supports_jax, supports_latex: Whether this expression type supports the corresponding export format.</li>
</ul>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractExpressionSpec.create_exports" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_exports</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">equations</span><span class="p">,</span> <span class="n">search_output</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractExpressionSpec.create_exports" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create additional columns in the equations dataframe.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/expression_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_exports</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">PySRRegressor</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">equations</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">search_output</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create additional columns in the equations dataframe.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractExpressionSpec.julia_expression_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">julia_expression_spec</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractExpressionSpec.julia_expression_spec" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The expression specification</p>


            <details class="quote">
              <summary>Source code in <code>pysr/expression_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="k">def</span><span class="w"> </span><span class="nf">julia_expression_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyValue</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The expression specification&quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="logger-specifications">Logger Specifications<a class="headerlink" href="#logger-specifications" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="pysr.TensorBoardLoggerSpec" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TensorBoardLoggerSpec</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s1">&#39;logs/run&#39;</span><span class="p">,</span> <span class="n">log_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#pysr.TensorBoardLoggerSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Specification for TensorBoard logger.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>log_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where TensorBoard logs will be saved. If <code>overwrite</code> is <code>False</code>,
new logs will be saved to <code>{log_dir}_1</code>, and so on. Default is <code>"logs/run"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;logs/run&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval (in steps) at which logs are written. Default is 10.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite existing logs in the directory. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="pysr.AbstractLoggerSpec" class="doc doc-heading">
            <code>AbstractLoggerSpec</code>


<a href="#pysr.AbstractLoggerSpec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">


        <p>Abstract base class for logger specifications.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractLoggerSpec.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractLoggerSpec.close" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Close the logger instance.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/logger_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">AnyValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Close the logger instance.&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractLoggerSpec.create_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_logger</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractLoggerSpec.create_logger" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a logger instance.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/logger_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyValue</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a logger instance.&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="pysr.AbstractLoggerSpec.write_hparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_hparams</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">hparams</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#pysr.AbstractLoggerSpec.write_hparams" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Write hyperparameters to the logger.</p>


            <details class="quote">
              <summary>Source code in <code>pysr/logger_specs.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">write_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">AnyValue</span><span class="p">,</span> <span class="n">hparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write hyperparameters to the logger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../examples/">
      
      
        <link rel="next" href="../operators/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>PySRRegressor Reference - PySR</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pysrregressor-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://astroautomata.com/PySR" title="PySR" class="md-header__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PySR
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PySRRegressor Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="pysr" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://astroautomata.com/PySR" title="PySR" class="md-nav__button md-logo" aria-label="PySR" data-md-component="logo">
      
  <img src="../assets/pysr_logo_reduced.svg" alt="logo">

    </a>
    PySR
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MilesCranmer/PySR" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toy Examples with Code
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    PySRRegressor Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    PySRRegressor Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      The Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-search-space" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Search Space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-the-search-size" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the Search Size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-objective" class="md-nav__link">
    <span class="md-ellipsis">
      The Objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-complexities" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Complexities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutations" class="md-nav__link">
    <span class="md-ellipsis">
      Mutations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tournament-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Tournament Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constant-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Constant Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-between-populations" class="md-nav__link">
    <span class="md-ellipsis">
      Migration between Populations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Stopping Criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-and-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance and Parallelization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determinism" class="md-nav__link">
    <span class="md-ellipsis">
      Determinism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    <span class="md-ellipsis">
      Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exporting-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting the Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.sympy" class="md-nav__link">
    <span class="md-ellipsis">
      sympy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex" class="md-nav__link">
    <span class="md-ellipsis">
      latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.jax" class="md-nav__link">
    <span class="md-ellipsis">
      jax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex_table" class="md-nav__link">
    <span class="md-ellipsis">
      latex_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operators
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning and Workflow Tips
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features and Options
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../papers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Research
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../interactive-docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interactive Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      The Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-search-space" class="md-nav__link">
    <span class="md-ellipsis">
      Creating the Search Space
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-the-search-size" class="md-nav__link">
    <span class="md-ellipsis">
      Setting the Search Size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-objective" class="md-nav__link">
    <span class="md-ellipsis">
      The Objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-complexities" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Complexities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutations" class="md-nav__link">
    <span class="md-ellipsis">
      Mutations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tournament-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Tournament Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constant-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Constant Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migration-between-populations" class="md-nav__link">
    <span class="md-ellipsis">
      Migration between Populations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Data Preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Stopping Criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-and-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      Performance and Parallelization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determinism" class="md-nav__link">
    <span class="md-ellipsis">
      Determinism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    <span class="md-ellipsis">
      Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exporting-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting the Results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pysrregressor-functions" class="md-nav__link">
    <span class="md-ellipsis">
      PySRRegressor Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PySRRegressor Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.sympy" class="md-nav__link">
    <span class="md-ellipsis">
      sympy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex" class="md-nav__link">
    <span class="md-ellipsis">
      latex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      pytorch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.jax" class="md-nav__link">
    <span class="md-ellipsis">
      jax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.latex_table" class="md-nav__link">
    <span class="md-ellipsis">
      latex_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysr.PySRRegressor.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="pysrregressor-reference">PySRRegressor Reference<a class="headerlink" href="#pysrregressor-reference" title="Permanent link">&para;</a></h1>
<p><code>PySRRegressor</code> has many options for controlling a symbolic regression search.
Let's look at them below.</p>
<h2 id="pysrregressor-parameters">PySRRegressor Parameters<a class="headerlink" href="#pysrregressor-parameters" title="Permanent link">&para;</a></h2>
<h3 id="the-algorithm">The Algorithm<a class="headerlink" href="#the-algorithm" title="Permanent link">&para;</a></h3>
<h4 id="creating-the-search-space">Creating the Search Space<a class="headerlink" href="#creating-the-search-space" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>binary_operators</code></strong></p>
<p>List of strings for binary operators used in the search.
See the <a href="https://astroautomata.com/PySR/operators/">operators page</a>
for more details.</p>
<p><em>Default:</em> <code>["+", "-", "*", "/"]</code></p>
</li>
<li>
<p><strong><code>unary_operators</code></strong></p>
<p>Operators which only take a single scalar as input.
For example, <code>"cos"</code> or <code>"exp"</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>maxsize</code></strong></p>
<p>Max complexity of an equation.  </p>
<p><em>Default:</em> <code>20</code></p>
</li>
<li>
<p><strong><code>maxdepth</code></strong></p>
<p>Max depth of an equation. You can use both <code>maxsize</code> and
<code>maxdepth</code>. <code>maxdepth</code> is by default not used.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h4 id="setting-the-search-size">Setting the Search Size<a class="headerlink" href="#setting-the-search-size" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>niterations</code></strong></p>
<p>Number of iterations of the algorithm to run. The best
equations are printed and migrate between populations at the
end of each iteration.</p>
<p><em>Default:</em> <code>40</code></p>
</li>
<li>
<p><strong><code>populations</code></strong></p>
<p>Number of populations running.</p>
<p><em>Default:</em> <code>15</code></p>
</li>
<li>
<p><strong><code>population_size</code></strong></p>
<p>Number of individuals in each population.</p>
<p><em>Default:</em> <code>33</code></p>
</li>
<li>
<p><strong><code>ncycles_per_iteration</code></strong></p>
<p>Number of total mutations to run, per 10 samples of the
population, per iteration.</p>
<p><em>Default:</em> <code>550</code></p>
</li>
</ul>
<h4 id="the-objective">The Objective<a class="headerlink" href="#the-objective" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>elementwise_loss</code></strong></p>
<p>String of Julia code specifying an elementwise loss function.
Can either be a loss from LossFunctions.jl, or your own loss
written as a function. Examples of custom written losses include:
<code>myloss(x, y) = abs(x-y)</code> for non-weighted, or
<code>myloss(x, y, w) = w*abs(x-y)</code> for weighted.
The included losses include:
Regression: <code>LPDistLoss{P}()</code>, <code>L1DistLoss()</code>,
<code>L2DistLoss()</code> (mean square), <code>LogitDistLoss()</code>,
<code>HuberLoss(d)</code>, <code>L1EpsilonInsLoss(ϵ)</code>, <code>L2EpsilonInsLoss(ϵ)</code>,
<code>PeriodicLoss(c)</code>, <code>QuantileLoss(τ)</code>.
Classification: <code>ZeroOneLoss()</code>, <code>PerceptronLoss()</code>,
<code>L1HingeLoss()</code>, <code>SmoothedL1HingeLoss(γ)</code>,
<code>ModifiedHuberLoss()</code>, <code>L2MarginLoss()</code>, <code>ExpLoss()</code>,
<code>SigmoidLoss()</code>, <code>DWDMarginLoss(q)</code>.</p>
<p><em>Default:</em> <code>"L2DistLoss()"</code></p>
</li>
<li>
<p><strong><code>loss_function</code></strong></p>
<p>Alternatively, you can specify the full objective function as
a snippet of Julia code, including any sort of custom evaluation
(including symbolic manipulations beforehand), and any sort
of loss function or regularizations. The default <code>loss_function</code>
used in SymbolicRegression.jl is roughly equal to:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">function</span><span class="w"> </span><span class="n">eval_loss</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="o">::</span><span class="kt">Dataset</span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">L</span><span class="p">},</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="o">::</span><span class="kt">L</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">{</span><span class="kt">T</span><span class="p">,</span><span class="kt">L</span><span class="p">}</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="n">prediction</span><span class="p">,</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eval_tree_array</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">flag</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="nb">Inf</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sum</span><span class="p">((</span><span class="n">prediction</span><span class="w"> </span><span class="o">.-</span><span class="w"> </span><span class="n">dataset</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">.^</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dataset</span><span class="o">.</span><span class="n">n</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">end</span>
</code></pre></div>
where the example elementwise loss is mean-squared error.
You may pass a function with the same arguments as this (note
that the name of the function doesn't matter). Here,
both <code>prediction</code> and <code>dataset.y</code> are 1D arrays of length <code>dataset.n</code>.
If using <code>batching</code>, then you should add an
<code>idx</code> argument to the function, which is <code>nothing</code>
for non-batched, and a 1D array of indices for batched.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>model_selection</code></strong></p>
<p>Model selection criterion when selecting a final expression from
the list of best expression at each complexity.
Can be <code>'accuracy'</code>, <code>'best'</code>, or <code>'score'</code>. 
<code>'accuracy'</code> selects the candidate model with the lowest loss
(highest accuracy).
<code>'score'</code> selects the candidate model with the highest score.
Score is defined as the negated derivative of the log-loss with
respect to complexity - if an expression has a much better
loss at a slightly higher complexity, it is preferred.
<code>'best'</code> selects the candidate model with the highest score
among expressions with a loss better than at least 1.5x the
most accurate model.</p>
<p><em>Default:</em> <code>'best'</code></p>
</li>
<li>
<p><strong><code>dimensional_constraint_penalty</code></strong></p>
<p>Additive penalty for if dimensional analysis of an expression fails.
By default, this is <code>1000.0</code>.</p>
</li>
<li>
<p><strong><code>dimensionless_constants_only</code></strong></p>
<p>Whether to only search for dimensionless constants, if using units.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
</ul>
<h4 id="working-with-complexities">Working with Complexities<a class="headerlink" href="#working-with-complexities" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>parsimony</code></strong></p>
<p>Multiplicative factor for how much to punish complexity.</p>
<p><em>Default:</em> <code>0.0032</code></p>
</li>
<li>
<p><strong><code>constraints</code></strong></p>
<p>Dictionary of int (unary) or 2-tuples (binary), this enforces
maxsize constraints on the individual arguments of operators.
E.g., <code>'pow': (-1, 1)</code> says that power laws can have any
complexity left argument, but only 1 complexity in the right
argument. Use this to force more interpretable solutions.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>nested_constraints</code></strong></p>
<p>Specifies how many times a combination of operators can be
nested. For example, <code>{"sin": {"cos": 0}}, "cos": {"cos": 2}}</code>
specifies that <code>cos</code> may never appear within a <code>sin</code>, but <code>sin</code>
can be nested with itself an unlimited number of times. The
second term specifies that <code>cos</code> can be nested up to 2 times
within a <code>cos</code>, so that <code>cos(cos(cos(x)))</code> is allowed
(as well as any combination of <code>+</code> or <code>-</code> within it), but
<code>cos(cos(cos(cos(x))))</code> is not allowed. When an operator is not
specified, it is assumed that it can be nested an unlimited
number of times. This requires that there is no operator which
is used both in the unary operators and the binary operators
(e.g., <code>-</code> could be both subtract, and negation). For binary
operators, you only need to provide a single number: both
arguments are treated the same way, and the max of each
argument is constrained.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>complexity_of_operators</code></strong></p>
<p>If you would like to use a complexity other than 1 for an
operator, specify the complexity here. For example,
<code>{"sin": 2, "+": 1}</code> would give a complexity of 2 for each use
of the <code>sin</code> operator, and a complexity of 1 for each use of
the <code>+</code> operator (which is the default). You may specify real
numbers for a complexity, and the total complexity of a tree
will be rounded to the nearest integer after computing.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>complexity_of_constants</code></strong></p>
<p>Complexity of constants. </p>
<p><em>Default:</em> <code>1</code></p>
</li>
<li>
<p><strong><code>complexity_of_variables</code></strong></p>
<p>Global complexity of variables. To set different complexities for
different variables, pass a list of complexities to the <code>fit</code> method
with keyword <code>complexity_of_variables</code>. You cannot use both.</p>
<p><em>Default:</em> <code>1</code></p>
</li>
<li>
<p><strong><code>warmup_maxsize_by</code></strong></p>
<p>Whether to slowly increase max size from a small number up to
the maxsize (if greater than 0).  If greater than 0, says the
fraction of training time at which the current maxsize will
reach the user-passed maxsize.</p>
<p><em>Default:</em> <code>0.0</code></p>
</li>
<li>
<p><strong><code>use_frequency</code></strong></p>
<p>Whether to measure the frequency of complexities, and use that
instead of parsimony to explore equation space. Will naturally
find equations of all complexities.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>use_frequency_in_tournament</code></strong></p>
<p>Whether to use the frequency mentioned above in the tournament,
rather than just the simulated annealing.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>adaptive_parsimony_scaling</code></strong></p>
<p>If the adaptive parsimony strategy (<code>use_frequency</code> and
<code>use_frequency_in_tournament</code>), this is how much to (exponentially)
weight the contribution. If you find that the search is only optimizing
the most complex expressions while the simpler expressions remain stagnant,
you should increase this value.</p>
<p><em>Default:</em> <code>20.0</code></p>
</li>
<li>
<p><strong><code>should_simplify</code></strong></p>
<p>Whether to use algebraic simplification in the search. Note that only
a few simple rules are implemented. </p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h4 id="mutations">Mutations<a class="headerlink" href="#mutations" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>weight_add_node</code></strong></p>
<p>Relative likelihood for mutation to add a node.</p>
<p><em>Default:</em> <code>0.79</code></p>
</li>
<li>
<p><strong><code>weight_insert_node</code></strong></p>
<p>Relative likelihood for mutation to insert a node.</p>
<p><em>Default:</em> <code>5.1</code></p>
</li>
<li>
<p><strong><code>weight_delete_node</code></strong></p>
<p>Relative likelihood for mutation to delete a node.</p>
<p><em>Default:</em> <code>1.7</code></p>
</li>
<li>
<p><strong><code>weight_do_nothing</code></strong></p>
<p>Relative likelihood for mutation to leave the individual.</p>
<p><em>Default:</em> <code>0.21</code></p>
</li>
<li>
<p><strong><code>weight_mutate_constant</code></strong></p>
<p>Relative likelihood for mutation to change the constant slightly
in a random direction.</p>
<p><em>Default:</em> <code>0.048</code></p>
</li>
<li>
<p><strong><code>weight_mutate_operator</code></strong></p>
<p>Relative likelihood for mutation to swap an operator.</p>
<p><em>Default:</em> <code>0.47</code></p>
</li>
<li>
<p><strong><code>weight_swap_operands</code></strong></p>
<p>Relative likehood for swapping operands in binary operators.</p>
<p><em>Default:</em> <code>0.1</code></p>
</li>
<li>
<p><strong><code>weight_randomize</code></strong></p>
<p>Relative likelihood for mutation to completely delete and then
randomly generate the equation</p>
<p><em>Default:</em> <code>0.00023</code></p>
</li>
<li>
<p><strong><code>weight_simplify</code></strong></p>
<p>Relative likelihood for mutation to simplify constant parts by evaluation</p>
<p><em>Default:</em> <code>0.0020</code></p>
</li>
<li>
<p><strong><code>weight_optimize</code></strong></p>
<p>Constant optimization can also be performed as a mutation, in addition to
the normal strategy controlled by <code>optimize_probability</code> which happens
every iteration. Using it as a mutation is useful if you want to use
a large <code>ncycles_periteration</code>, and may not optimize very often.</p>
<p><em>Default:</em> <code>0.0</code></p>
</li>
<li>
<p><strong><code>crossover_probability</code></strong></p>
<p>Absolute probability of crossover-type genetic operation, instead of a mutation.</p>
<p><em>Default:</em> <code>0.066</code></p>
</li>
<li>
<p><strong><code>annealing</code></strong></p>
<p>Whether to use annealing.  </p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>alpha</code></strong></p>
<p>Initial temperature for simulated annealing
(requires <code>annealing</code> to be <code>True</code>).</p>
<p><em>Default:</em> <code>0.1</code></p>
</li>
<li>
<p><strong><code>perturbation_factor</code></strong></p>
<p>Constants are perturbed by a max factor of
(perturbation_factor*T + 1). Either multiplied by this or
divided by this.</p>
<p><em>Default:</em> <code>0.076</code></p>
</li>
<li>
<p><strong><code>skip_mutation_failures</code></strong></p>
<p>Whether to skip mutation and crossover failures, rather than
simply re-sampling the current member.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h4 id="tournament-selection">Tournament Selection<a class="headerlink" href="#tournament-selection" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>tournament_selection_n</code></strong></p>
<p>Number of expressions to consider in each tournament.</p>
<p><em>Default:</em> <code>10</code></p>
</li>
<li>
<p><strong><code>tournament_selection_p</code></strong></p>
<p>Probability of selecting the best expression in each
tournament. The probability will decay as p*(1-p)^n for other
expressions, sorted by loss.</p>
<p><em>Default:</em> <code>0.86</code></p>
</li>
</ul>
<h4 id="constant-optimization">Constant Optimization<a class="headerlink" href="#constant-optimization" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>optimizer_algorithm</code></strong></p>
<p>Optimization scheme to use for optimizing constants. Can currently
be <code>NelderMead</code> or <code>BFGS</code>.</p>
<p><em>Default:</em> <code>"BFGS"</code></p>
</li>
<li>
<p><strong><code>optimizer_nrestarts</code></strong></p>
<p>Number of time to restart the constants optimization process with
different initial conditions.</p>
<p><em>Default:</em> <code>2</code></p>
</li>
<li>
<p><strong><code>optimize_probability</code></strong></p>
<p>Probability of optimizing the constants during a single iteration of
the evolutionary algorithm.</p>
<p><em>Default:</em> <code>0.14</code></p>
</li>
<li>
<p><strong><code>optimizer_iterations</code></strong></p>
<p>Number of iterations that the constants optimizer can take.</p>
<p><em>Default:</em> <code>8</code></p>
</li>
<li>
<p><strong><code>should_optimize_constants</code></strong></p>
<p>Whether to numerically optimize constants (Nelder-Mead/Newton)
at the end of each iteration. </p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h4 id="migration-between-populations">Migration between Populations<a class="headerlink" href="#migration-between-populations" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong><code>fraction_replaced</code></strong></p>
<p>How much of population to replace with migrating equations from
other populations.</p>
<p><em>Default:</em> <code>0.000364</code></p>
</li>
<li>
<p><strong><code>fraction_replaced_hof</code></strong></p>
<p>How much of population to replace with migrating equations from
hall of fame. </p>
<p><em>Default:</em> <code>0.035</code></p>
</li>
<li>
<p><strong><code>migration</code></strong></p>
<p>Whether to migrate.  </p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>hof_migration</code></strong></p>
<p>Whether to have the hall of fame migrate.  </p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>topn</code></strong></p>
<p>How many top individuals migrate from each population.</p>
<p><em>Default:</em> <code>12</code></p>
</li>
</ul>
<h3 id="data-preprocessing">Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>denoise</code></strong></p>
<p>Whether to use a Gaussian Process to denoise the data before
inputting to PySR. Can help PySR fit noisy data.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>select_k_features</code></strong></p>
<p>Whether to run feature selection in Python using random forests,
before passing to the symbolic regression code. None means no
feature selection; an int means select that many features.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h3 id="stopping-criteria">Stopping Criteria<a class="headerlink" href="#stopping-criteria" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>max_evals</code></strong></p>
<p>Limits the total number of evaluations of expressions to
this number.  </p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>timeout_in_seconds</code></strong></p>
<p>Make the search return early once this many seconds have passed.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>early_stop_condition</code></strong></p>
<p>Stop the search early if this loss is reached. You may also
pass a string containing a Julia function which
takes a loss and complexity as input, for example:
<code>"f(loss, complexity) = (loss &lt; 0.1) &amp;&amp; (complexity &lt; 10)"</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h3 id="performance-and-parallelization">Performance and Parallelization<a class="headerlink" href="#performance-and-parallelization" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>procs</code></strong></p>
<p>Number of processes (=number of populations running).</p>
<p><em>Default:</em> <code>cpu_count()</code></p>
</li>
<li>
<p><strong><code>multithreading</code></strong></p>
<p>Use multithreading instead of distributed backend.
Using procs=0 will turn off both. </p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>cluster_manager</code></strong></p>
<p>For distributed computing, this sets the job queue system. Set
to one of "slurm", "pbs", "lsf", "sge", "qrsh", "scyld", or
"htc". If set to one of these, PySR will run in distributed
mode, and use <code>procs</code> to figure out how many processes to launch.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>heap_size_hint_in_bytes</code></strong></p>
<p>For multiprocessing, this sets the <code>--heap-size-hint</code> parameter
for new Julia processes. This can be configured when using
multi-node distributed compute, to give a hint to each process
about how much memory they can use before aggressive garbage
collection.</p>
</li>
<li>
<p><strong><code>batching</code></strong></p>
<p>Whether to compare population members on small batches during
evolution. Still uses full dataset for comparing against hall
of fame. </p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>batch_size</code></strong></p>
<p>The amount of data to use if doing batching. </p>
<p><em>Default:</em> <code>50</code></p>
</li>
<li>
<p><strong><code>precision</code></strong></p>
<p>What precision to use for the data. By default this is <code>32</code>
(float32), but you can select <code>64</code> or <code>16</code> as well, giving
you 64 or 16 bits of floating point precision, respectively.
If you pass complex data, the corresponding complex precision
will be used (i.e., <code>64</code> for complex128, <code>32</code> for complex64).</p>
<p><em>Default:</em> <code>32</code></p>
</li>
<li>
<p><strong><code>fast_cycle</code></strong></p>
<p>Batch over population subsamples. This is a slightly different
algorithm than regularized evolution, but does cycles 15%
faster. May be algorithmically less efficient.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>turbo</code></strong></p>
<p>(Experimental) Whether to use LoopVectorization.jl to speed up the
search evaluation. Certain operators may not be supported.
Does not support 16-bit precision floats.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>bumper</code></strong></p>
<p>(Experimental) Whether to use Bumper.jl to speed up the search
evaluation. Does not support 16-bit precision floats.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>enable_autodiff</code></strong></p>
<p>Whether to create derivative versions of operators for automatic
differentiation. This is only necessary if you wish to compute
the gradients of an expression within a custom loss function.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
</ul>
<h3 id="determinism">Determinism<a class="headerlink" href="#determinism" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>random_state</code></strong></p>
<p>Pass an int for reproducible results across multiple function calls.
See :term:<code>Glossary &lt;random_state&gt;</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>deterministic</code></strong></p>
<p>Make a PySR search give the same result every run.
To use this, you must turn off parallelism
(with <code>procs</code>=0, <code>multithreading</code>=False),
and set <code>random_state</code> to a fixed seed.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>warm_start</code></strong></p>
<p>Tells fit to continue from where the last call to fit finished.
If false, each call to fit will be fresh, overwriting previous results.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
</ul>
<h3 id="monitoring">Monitoring<a class="headerlink" href="#monitoring" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>verbosity</code></strong></p>
<p>What verbosity level to use. 0 means minimal print statements.</p>
<p><em>Default:</em> <code>1</code></p>
</li>
<li>
<p><strong><code>update_verbosity</code></strong></p>
<p>What verbosity level to use for package updates.
Will take value of <code>verbosity</code> if not given.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>print_precision</code></strong></p>
<p>How many significant digits to print for floats. </p>
<p><em>Default:</em> <code>5</code></p>
</li>
<li>
<p><strong><code>progress</code></strong></p>
<p>Whether to use a progress bar instead of printing to stdout.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
</ul>
<h3 id="environment">Environment<a class="headerlink" href="#environment" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>temp_equation_file</code></strong></p>
<p>Whether to put the hall of fame file in the temp directory.
Deletion is then controlled with the <code>delete_tempfiles</code>
parameter.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>tempdir</code></strong></p>
<p>directory for the temporary files. </p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>delete_tempfiles</code></strong></p>
<p>Whether to delete the temporary files after finishing.</p>
<p><em>Default:</em> <code>True</code></p>
</li>
<li>
<p><strong><code>update</code></strong></p>
<p>Whether to automatically update Julia packages when <code>fit</code> is called.
You should make sure that PySR is up-to-date itself first, as
the packaged Julia packages may not necessarily include all
updated dependencies.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
</ul>
<h3 id="exporting-the-results">Exporting the Results<a class="headerlink" href="#exporting-the-results" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>equation_file</code></strong></p>
<p>Where to save the files (.csv extension).</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>output_jax_format</code></strong></p>
<p>Whether to create a 'jax_format' column in the output,
containing jax-callable functions and the default parameters in
a jax array.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>output_torch_format</code></strong></p>
<p>Whether to create a 'torch_format' column in the output,
containing a torch module with trainable parameters.</p>
<p><em>Default:</em> <code>False</code></p>
</li>
<li>
<p><strong><code>extra_sympy_mappings</code></strong></p>
<p>Provides mappings between custom <code>binary_operators</code> or
<code>unary_operators</code> defined in julia strings, to those same
operators defined in sympy.
E.G if <code>unary_operators=["inv(x)=1/x"]</code>, then for the fitted
model to be export to sympy, <code>extra_sympy_mappings</code>
would be <code>{"inv": lambda x: 1/x}</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>extra_torch_mappings</code></strong></p>
<p>The same as <code>extra_jax_mappings</code> but for model export
to pytorch. Note that the dictionary keys should be callable
pytorch expressions.
For example: <code>extra_torch_mappings={sympy.sin: torch.sin}</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
<li>
<p><strong><code>extra_jax_mappings</code></strong></p>
<p>Similar to <code>extra_sympy_mappings</code> but for model export
to jax. The dictionary maps sympy functions to jax functions.
For example: <code>extra_jax_mappings={sympy.sin: "jnp.sin"}</code> maps
the <code>sympy.sin</code> function to the equivalent jax expression <code>jnp.sin</code>.</p>
<p><em>Default:</em> <code>None</code></p>
</li>
</ul>
<h2 id="pysrregressor-functions">PySRRegressor Functions<a class="headerlink" href="#pysrregressor-functions" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Xresampled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variable_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complexity_of_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X_units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_units</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Search for equations to fit the dataset and store them in <code>self.equations_</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data of shape (n_samples, n_features).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target values of shape (n_samples,) or (n_samples, n_targets).
Will be cast to X's dtype if necessary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Xresampled</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resampled training data, of shape (n_resampled, n_features),
to generate a denoised data on. This
will be used as the training data, rather than <code>X</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight array of the same shape as <code>y</code>.
Each element is how to weight the mean-square-error loss
for that particular element of <code>y</code>. Alternatively,
if a custom <code>loss</code> was set, it will can be used
in arbitrary ways.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variable_names</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of names for the variables, rather than "x0", "x1", etc.
If <code>X</code> is a pandas dataframe, the column names will be used
instead of <code>variable_names</code>. Cannot contain spaces or special
characters. Avoid variable names which are also
function names in <code>sympy</code>, such as "N".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_units</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of units for each variable in <code>X</code>. Each unit should be
a string representing a Julia expression. See DynamicQuantities.jl
https://symbolicml.org/DynamicQuantities.jl/dev/units/ for more
information.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_units</code>
            </td>
            <td>
                  <code>str | list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similar to <code>X_units</code>, but as a unit for the target variable, <code>y</code>.
If <code>y</code> is a matrix, a list of units should be passed. If <code>X_units</code>
is given but <code>y_units</code> is not, then <code>y_units</code> will be arbitrary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted estimator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>    <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>    <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>    <span class="n">Xresampled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>    <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>    <span class="n">variable_names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>    <span class="n">complexity_of_variables</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>        <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>    <span class="n">X_units</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>    <span class="n">y_units</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PySRRegressor&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a><span class="sd">    Search for equations to fit the dataset and store them in `self.equations_`.</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a><span class="sd">    X : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a><span class="sd">        Training data of shape (n_samples, n_features).</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a><span class="sd">    y : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a><span class="sd">        Target values of shape (n_samples,) or (n_samples, n_targets).</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a><span class="sd">        Will be cast to X&#39;s dtype if necessary.</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a><span class="sd">    Xresampled : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a><span class="sd">        Resampled training data, of shape (n_resampled, n_features),</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a><span class="sd">        to generate a denoised data on. This</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a><span class="sd">        will be used as the training data, rather than `X`.</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><span class="sd">    weights : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a><span class="sd">        Weight array of the same shape as `y`.</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a><span class="sd">        Each element is how to weight the mean-square-error loss</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a><span class="sd">        for that particular element of `y`. Alternatively,</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a><span class="sd">        if a custom `loss` was set, it will can be used</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a><span class="sd">        in arbitrary ways.</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a><span class="sd">    variable_names : list[str]</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="sd">        A list of names for the variables, rather than &quot;x0&quot;, &quot;x1&quot;, etc.</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a><span class="sd">        If `X` is a pandas dataframe, the column names will be used</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a><span class="sd">        instead of `variable_names`. Cannot contain spaces or special</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a><span class="sd">        characters. Avoid variable names which are also</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a><span class="sd">        function names in `sympy`, such as &quot;N&quot;.</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a><span class="sd">    X_units : list[str]</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a><span class="sd">        A list of units for each variable in `X`. Each unit should be</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a><span class="sd">        a string representing a Julia expression. See DynamicQuantities.jl</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a><span class="sd">        https://symbolicml.org/DynamicQuantities.jl/dev/units/ for more</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a><span class="sd">        information.</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a><span class="sd">    y_units : str | list[str]</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a><span class="sd">        Similar to `X_units`, but as a unit for the target variable, `y`.</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a><span class="sd">        If `y` is a matrix, a list of units should be passed. If `X_units`</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a><span class="sd">        is given but `y_units` is not, then `y_units` will be arbitrary.</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a><span class="sd">    self : object</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a><span class="sd">        Fitted estimator.</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>    <span class="c1"># Init attributes that are not specified in BaseEstimator</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;julia_state_stream_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>        <span class="k">pass</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;julia_state_stream_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>                <span class="s2">&quot;The discovered expressions are being reset. &quot;</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>                <span class="s2">&quot;Please set `warm_start=True` if you wish to continue &quot;</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>                <span class="s2">&quot;to start a search where you left off.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>            <span class="p">)</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">julia_state_stream_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">julia_options_stream_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">complexity_of_variables_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_units_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_units_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_equation_file</span><span class="p">()</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>    <span class="n">runtime_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_modify_params</span><span class="p">()</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>    <span class="p">(</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>        <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_set_fit_params</span><span class="p">(</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>        <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>    <span class="p">)</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">batching</span><span class="p">:</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a>            <span class="s2">&quot;Note: you are running with more than 10,000 datapoints. &quot;</span>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a>            <span class="s2">&quot;You should consider turning on batching (https://astroautomata.com/PySR/options/#batching). &quot;</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>            <span class="s2">&quot;You should also reconsider if you need that many datapoints. &quot;</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>            <span class="s2">&quot;Unless you have a large amount of noise (in which case you &quot;</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a>            <span class="s2">&quot;should smooth your dataset first), generally &lt; 10,000 datapoints &quot;</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a>            <span class="s2">&quot;is enough to find a functional form with symbolic regression. &quot;</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a>            <span class="s2">&quot;More datapoints will lower the search speed.&quot;</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a>        <span class="p">)</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a>    <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>  <span class="c1"># For np random</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a>    <span class="n">seed</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># For julia random</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a>    <span class="c1"># Pre transformations (feature selection and denoising)</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">variable_names</span><span class="p">,</span> <span class="n">complexity_of_variables</span><span class="p">,</span> <span class="n">X_units</span><span class="p">,</span> <span class="n">y_units</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pre_transform_training_data</span><span class="p">(</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a>            <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a>            <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a>            <span class="n">Xresampled</span><span class="p">,</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>            <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a>            <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a>            <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a>            <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a>            <span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a>        <span class="p">)</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a>    <span class="p">)</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a>    <span class="c1"># Warn about large feature counts (still warn if feature count is large</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a>    <span class="c1"># after running feature selection)</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a>            <span class="s2">&quot;Note: you are running with 10 features or more. &quot;</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a>            <span class="s2">&quot;Genetic algorithms like used in PySR scale poorly with large numbers of features. &quot;</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a>            <span class="s2">&quot;You should run PySR for more `niterations` to ensure it can find &quot;</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a>            <span class="s2">&quot;the correct variables, and consider using a larger `maxsize`.&quot;</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a>        <span class="p">)</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a>    <span class="c1"># Assertion checks</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>    <span class="n">use_custom_variable_names</span> <span class="o">=</span> <span class="n">variable_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a>    <span class="c1"># TODO: this is always true.</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a>    <span class="n">_check_assertions</span><span class="p">(</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a>        <span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a>        <span class="n">use_custom_variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a>        <span class="n">variable_names</span><span class="p">,</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a>        <span class="n">complexity_of_variables</span><span class="p">,</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a>        <span class="n">weights</span><span class="p">,</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a>        <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a>        <span class="n">X_units</span><span class="p">,</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a>        <span class="n">y_units</span><span class="p">,</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a>    <span class="p">)</span>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a>    <span class="c1"># Initially, just save model parameters, so that</span>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a>    <span class="c1"># it can be loaded from an early exit:</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_equation_file</span><span class="p">:</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">()</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a>    <span class="c1"># Perform the search:</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">runtime_params</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>    <span class="c1"># Then, after fit, we save again, so the pickle file contains</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>    <span class="c1"># the equations:</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_equation_file</span><span class="p">:</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">()</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Predict y from input X using the equation chosen by <code>model_selection</code>.</p>
<p>You may see what equation is used by printing this object. X should
have the same columns as the training data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training data of shape <code>(n_samples, n_features)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int | list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you want to compute the output of an expression using a
particular row of <code>self.equations_</code>, you may specify the index here.
For multiple output equations, you must pass a list of indices
in the same order.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>y_predicted</code></td>            <td>
                  <code>ndarray of shape (n_samples, nout_)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values predicted by substituting <code>X</code> into the fitted symbolic
regression model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raises if the <code>best_equation</code> cannot be evaluated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2115" name="__codelineno-0-2115"></a><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a><span class="sd">    Predict y from input X using the equation chosen by `model_selection`.</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a><span class="sd">    You may see what equation is used by printing this object. X should</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a><span class="sd">    have the same columns as the training data.</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a><span class="sd">    X : ndarray | pandas.DataFrame</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a><span class="sd">        Training data of shape `(n_samples, n_features)`.</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a><span class="sd">        If you want to compute the output of an expression using a</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a><span class="sd">        particular row of `self.equations_`, you may specify the index here.</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a><span class="sd">        For multiple output equations, you must pass a list of indices</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a><span class="sd">        in the same order.</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a><span class="sd">    y_predicted : ndarray of shape (n_samples, nout_)</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a><span class="sd">        Values predicted by substituting `X` into the fitted symbolic</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a><span class="sd">        regression model.</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="sd">    ------</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a><span class="sd">        Raises if the `best_equation` cannot be evaluated.</span>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>    <span class="n">check_is_fitted</span><span class="p">(</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selection_mask_&quot;</span><span class="p">,</span> <span class="s2">&quot;feature_names_in_&quot;</span><span class="p">,</span> <span class="s2">&quot;nout_&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>    <span class="p">)</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>    <span class="c1"># When X is an numpy array or a pandas dataframe with a RangeIndex,</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>    <span class="c1"># the self.feature_names_in_ generated during fit, for the same X,</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>    <span class="c1"># will cause a warning to be thrown during _validate_data.</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>    <span class="c1"># To avoid this, convert X to a dataframe, apply the selection mask,</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>    <span class="c1"># and then set the column/feature_names of X to be equal to those</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>    <span class="c1"># generated during fit.</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">check_array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>            <span class="c1"># RangeIndex enforces column order allowing columns to</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>            <span class="c1"># be correctly filtered with self.selection_mask_</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_mask_</span><span class="p">]]</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>        <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_names_in_</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>    <span class="c1"># Without feature information, CallableEquation/lambda_format equations</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>    <span class="c1"># require that the column order of X matches that of the X used during</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>    <span class="c1"># the fitting process. _validate_data removes this feature information</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>    <span class="c1"># when it converts the dataframe to an np array. Thus, to ensure feature</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>    <span class="c1"># order is preserved after conversion, the dataframe columns must be</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>    <span class="c1"># reordered/reindexed to match those of the transformed (denoised and</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>    <span class="c1"># feature selected) X in fit.</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data_X</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>                <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;lambda_format&quot;</span><span class="p">](</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>            <span class="p">)</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>            <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;lambda_format&quot;</span><span class="p">](</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a>            <span class="s2">&quot;Failed to evaluate the expression. &quot;</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>            <span class="s2">&quot;If you are using a custom operator, make sure to define it in `extra_sympy_mappings`, &quot;</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a>            <span class="s2">&quot;e.g., `model.set_params(extra_sympy_mappings={&#39;inv&#39;: lambda x: 1/x})`, where &quot;</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>            <span class="s2">&quot;`lambda x: 1/x` is a valid SymPy function defining the operator. &quot;</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>            <span class="s2">&quot;You can then run `model.refresh()` to re-load the expressions.&quot;</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>        <span class="p">)</span> <span class="kn">from</span> <span class="nn">error</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_file</span><span class="p">(</span><span class="n">equation_file</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">binary_operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unary_operators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_features_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">feature_names_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selection_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pysr.PySRRegressor.from_file" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Create a model from a saved model checkpoint or equation file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>equation_file</code>
            </td>
            <td>
                  <code>str or <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a pickle file containing a saved model, or a csv file
containing equations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binary_operators</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The same binary operators used when creating the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unary_operators</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The same unary operators used when creating the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_features_in</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of features passed to the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_names_in</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the features passed to the model.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_mask</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If using <code>select_k_features</code>, you must pass <code>model.selection_mask_</code> here.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nout</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of outputs of the model.
Not needed if loading from a pickle file.
Default is <code>1</code>.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**pysr_kwargs</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any other keyword arguments to initialize the PySRRegressor object.
These will overwrite those stored in the pickle file.
Not needed if loading from a pickle file.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>model</code></td>            <td>
                  <code><span title="pysr.sr.PySRRegressor">PySRRegressor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model with fitted equations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="n">equation_file</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="n">binary_operators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="n">unary_operators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="n">n_features_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="n">feature_names_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="n">selection_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>    <span class="n">nout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>    <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="p">):</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">    Create a model from a saved model checkpoint or equation file.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">    equation_file : str or Path</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">        Path to a pickle file containing a saved model, or a csv file</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">        containing equations.</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">    binary_operators : list[str]</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">        The same binary operators used when creating the model.</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">    unary_operators : list[str]</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">        The same unary operators used when creating the model.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">    n_features_in : int</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        Number of features passed to the model.</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    feature_names_in : list[str]</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        Names of the features passed to the model.</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    selection_mask : NDArray[np.bool_]</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        If using `select_k_features`, you must pass `model.selection_mask_` here.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">    nout : int</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        Number of outputs of the model.</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        Default is `1`.</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">    **pysr_kwargs : dict</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        Any other keyword arguments to initialize the PySRRegressor object.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        These will overwrite those stored in the pickle file.</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        Not needed if loading from a pickle file.</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">    -------</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">    model : PySRRegressor</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        The model with fitted equations.</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="n">pkl_filename</span> <span class="o">=</span> <span class="n">_csv_filename_to_pkl_filename</span><span class="p">(</span><span class="n">equation_file</span><span class="p">)</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>    <span class="c1"># Try to load model from &lt;equation_file&gt;.pkl</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking if </span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2"> exists...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pkl_filename</span><span class="p">):</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading model from </span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="k">assert</span> <span class="n">binary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="k">assert</span> <span class="n">unary_operators</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="k">assert</span> <span class="n">n_features_in</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">pkl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="c1"># Change equation_file_ to be in the same dir as the pickle file</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pkl_filename</span><span class="p">)</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">base_equation_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">equation_file_</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="n">model</span><span class="o">.</span><span class="n">equation_file_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">base_equation_file</span><span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="c1"># Update any parameters if necessary, such as</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>        <span class="c1"># extra_sympy_mappings:</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="k">if</span> <span class="s2">&quot;equations_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="vm">__dict__</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">equations_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>            <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="k">return</span> <span class="n">model</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>    <span class="c1"># Else, we re-create it.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pkl_filename</span><span class="si">}</span><span class="s2"> does not exist, &quot;</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>        <span class="s2">&quot;so we must create the model from scratch.&quot;</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>    <span class="p">)</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>    <span class="k">assert</span> <span class="n">binary_operators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">unary_operators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>    <span class="k">assert</span> <span class="n">n_features_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>    <span class="c1"># TODO: copy .bkup file if exists.</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>    <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>        <span class="n">equation_file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">equation_file</span><span class="p">),</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>        <span class="n">binary_operators</span><span class="o">=</span><span class="n">binary_operators</span><span class="p">,</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="n">unary_operators</span><span class="o">=</span><span class="n">unary_operators</span><span class="p">,</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>        <span class="o">**</span><span class="n">pysr_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>    <span class="p">)</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>    <span class="n">model</span><span class="o">.</span><span class="n">nout_</span> <span class="o">=</span> <span class="n">nout</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="n">model</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">=</span> <span class="n">n_features_in</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>    <span class="k">if</span> <span class="n">feature_names_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="n">model</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">)])</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="n">model</span><span class="o">.</span><span class="n">display_feature_names_in_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">_subscriptify</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">)]</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="p">)</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_names_in</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_features_in</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>        <span class="n">model</span><span class="o">.</span><span class="n">feature_names_in_</span> <span class="o">=</span> <span class="n">feature_names_in</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>        <span class="n">model</span><span class="o">.</span><span class="n">display_feature_names_in_</span> <span class="o">=</span> <span class="n">feature_names_in</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="k">if</span> <span class="n">selection_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="n">model</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features_in</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>        <span class="n">model</span><span class="o">.</span><span class="n">selection_mask_</span> <span class="o">=</span> <span class="n">selection_mask</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>    <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">checkpoint_file</span><span class="o">=</span><span class="n">equation_file</span><span class="p">)</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.sympy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sympy</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.sympy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return sympy representation of the equation(s) chosen by <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int | list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>str, list[str] of length nout_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SymPy representation of the best equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><span class="k">def</span> <span class="nf">sympy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="sd">    Return sympy representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">    best_equation : str, list[str] of length nout_</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><span class="sd">        SymPy representation of the best equation.</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;sympy_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;sympy_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.latex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.latex" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return latex representation of the equation(s) chosen by <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int | list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of significant figures shown in the LaTeX
representation.
Default is <code>3</code>.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>str or list[str] of length nout_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LaTeX expression of the best equation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="k">def</span> <span class="nf">latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">    Return latex representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">    precision : int</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">        The number of significant figures shown in the LaTeX</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a><span class="sd">        representation.</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">        Default is `3`.</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">    best_equation : str or list[str] of length nout_</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a><span class="sd">        LaTeX expression of the best equation.</span>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a>    <span class="n">sympy_representation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sympy</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sympy_representation</span><span class="p">:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a>            <span class="n">latex</span> <span class="o">=</span> <span class="n">sympy2latex</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">latex</span><span class="p">)</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>        <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>    <span class="k">return</span> <span class="n">sympy2latex</span><span class="p">(</span><span class="n">sympy_representation</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.pytorch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pytorch</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.pytorch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return pytorch representation of the equation(s) chosen by <code>model_selection</code>.</p>
<p>Each equation (multiple given if there are multiple outputs) is a PyTorch module
containing the parameters as trainable attributes. You can use the module like
any other PyTorch module: <code>module(X)</code>, where <code>X</code> is a tensor with the same
column ordering as trained with.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int | list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PyTorch module representing the expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2280" name="__codelineno-0-2280"></a><span class="k">def</span> <span class="nf">pytorch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a><span class="sd">    Return pytorch representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a><span class="sd">    Each equation (multiple given if there are multiple outputs) is a PyTorch module</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><span class="sd">    containing the parameters as trainable attributes. You can use the module like</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a><span class="sd">    any other PyTorch module: `module(X)`, where `X` is a tensor with the same</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a><span class="sd">    column ordering as trained with.</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><span class="sd">    best_equation : torch.nn.Module</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a><span class="sd">        PyTorch module representing the expression.</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">output_torch_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;torch_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;torch_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.jax" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jax</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.jax" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Return jax representation of the equation(s) chosen by <code>model_selection</code>.</p>
<p>Each equation (multiple given if there are multiple outputs) is a dictionary
containing {"callable": func, "parameters": params}. To call <code>func</code>, pass
func(X, params). This function is differentiable using <code>jax.grad</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int | list[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular equation from
<code>self.equations_</code>, give the index number here. This overrides
the <code>model_selection</code> parameter. If there are multiple output
features, then pass a list of indices with the order the same
as the output feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>best_equation</code></td>            <td>
                  <code>dict[str, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of callable jax function in "callable" key,
and jax array of parameters as "parameters" key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="k">def</span> <span class="nf">jax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">    Return jax representation of the equation(s) chosen by `model_selection`.</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">    Each equation (multiple given if there are multiple outputs) is a dictionary</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><span class="sd">    containing {&quot;callable&quot;: func, &quot;parameters&quot;: params}. To call `func`, pass</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><span class="sd">    func(X, params). This function is differentiable using `jax.grad`.</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">    index : int | list[int]</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><span class="sd">        If you wish to select a particular equation from</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a><span class="sd">        `self.equations_`, give the index number here. This overrides</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">        the `model_selection` parameter. If there are multiple output</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="sd">        features, then pass a list of indices with the order the same</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">        as the output feature.</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a><span class="sd">    best_equation : dict[str, Any]</span>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><span class="sd">        Dictionary of callable jax function in &quot;callable&quot; key,</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">        and jax array of parameters as &quot;parameters&quot; key.</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">output_jax_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>    <span class="n">best_equation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">best_equation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span> <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">eq</span><span class="p">[</span><span class="s2">&quot;jax_format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">best_equation</span><span class="p">]</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>        <span class="k">return</span> <span class="n">best_equation</span><span class="p">[</span><span class="s2">&quot;jax_format&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.latex_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latex_table</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;equation&#39;</span><span class="p">,</span> <span class="s1">&#39;complexity&#39;</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;score&#39;</span><span class="p">])</span></code>

<a href="#pysr.PySRRegressor.latex_table" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Create a LaTeX/booktabs table for all, or some, of the equations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>indices</code>
            </td>
            <td>
                  <code>list[int] | list[list[int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If you wish to select a particular subset of equations from
<code>self.equations_</code>, give the row numbers here. By default,
all equations will be used. If there are multiple output
features, then pass a list of lists.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of significant figures shown in the LaTeX
representations.
Default is <code>3</code>.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which columns to include in the table.
Default is <code>["equation", "complexity", "loss", "score"]</code>.</p>
              </div>
            </td>
            <td>
                  <code>[&#39;equation&#39;, &#39;complexity&#39;, &#39;loss&#39;, &#39;score&#39;]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>latex_table_str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string that will render a table in LaTeX of the equations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2491" name="__codelineno-0-2491"></a><span class="k">def</span> <span class="nf">latex_table</span><span class="p">(</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>    <span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>    <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;equation&quot;</span><span class="p">,</span> <span class="s2">&quot;complexity&quot;</span><span class="p">,</span> <span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">],</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><span class="p">):</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a LaTeX/booktabs table for all, or some, of the equations.</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">    indices : list[int] | list[list[int]]</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a><span class="sd">        If you wish to select a particular subset of equations from</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">        `self.equations_`, give the row numbers here. By default,</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="sd">        all equations will be used. If there are multiple output</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">        features, then pass a list of lists.</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">    precision : int</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a><span class="sd">        The number of significant figures shown in the LaTeX</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">        representations.</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="sd">        Default is `3`.</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a><span class="sd">    columns : list[str]</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a><span class="sd">        Which columns to include in the table.</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="sd">        Default is `[&quot;equation&quot;, &quot;complexity&quot;, &quot;loss&quot;, &quot;score&quot;]`.</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a><span class="sd">    -------</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="sd">    latex_table_str : str</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="sd">        A string that will render a table in LaTeX of the equations.</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nout_</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>        <span class="n">table_string</span> <span class="o">=</span> <span class="n">sympy2multilatextable</span><span class="p">(</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>        <span class="p">)</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>        <span class="n">table_string</span> <span class="o">=</span> <span class="n">sympy2latextable</span><span class="p">(</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>        <span class="p">)</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>            <span class="s2">&quot;Invalid type for equations_ to pass to `latex_table`. &quot;</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>            <span class="s2">&quot;Expected a DataFrame or a list of DataFrames.&quot;</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>        <span class="p">)</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>    <span class="k">return</span> <span class="n">with_preamble</span><span class="p">(</span><span class="n">table_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pysr.PySRRegressor.refresh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">refresh</span><span class="p">(</span><span class="n">checkpoint_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pysr.PySRRegressor.refresh" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">

        <p>Update self.equations_ with any new options passed.</p>
<p>For example, updating <code>extra_sympy_mappings</code>
will require a <code>.refresh()</code> to update the equations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>checkpoint_file</code>
            </td>
            <td>
                  <code>str or <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to checkpoint hall of fame file to be loaded.
The default will use the set <code>equation_file_</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pysr/sr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2096" name="__codelineno-0-2096"></a><span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checkpoint_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PathLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a><span class="sd">    Update self.equations_ with any new options passed.</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a><span class="sd">    For example, updating `extra_sympy_mappings`</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a><span class="sd">    will require a `.refresh()` to update the equations.</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a><span class="sd">    checkpoint_file : str or Path</span>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a><span class="sd">        Path to checkpoint hall of fame file to be loaded.</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a><span class="sd">        The default will use the set `equation_file_`.</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>    <span class="k">if</span> <span class="n">checkpoint_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equation_file_</span> <span class="o">=</span> <span class="n">checkpoint_file</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">equation_file_contents_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>    <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;equation_file_&quot;</span><span class="p">])</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">equations_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hof</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>